```ABAP

DATA: OK_CODE TYPE SY-UCOMM,
      GO_CONT TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV  TYPE REF TO CL_GUI_ALV_GRID,
      GT_SCARR TYPE TABLE OF SCARR,
      GS_SCARR LIKE LINE OF GT_SCARR.

DATA: GT_DATA TYPE TABLE OF ZSSEATS_B13,
      GS_DATA LIKE LINE OF GT_DATA.

SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME.
  SELECT-OPTIONS: SO_CAR FOR GS_DATA-CARRID,
                  SO_CON FOR GS_DATA-CONNID,
                  SO_FDATE FOR GS_DATA-FLDATE.
SELECTION-SCREEN END OF BLOCK BLK1.


FORM GET_DATA .
  SELECT *
  INTO TABLE GT_SCARR
  FROM SCARR.

  SELECT *
    INTO CORRESPONDING FIELDS OF TABLE GT_DATA
    FROM SFLIGHT
    WHERE CARRID IN SO_CAR
      AND CONNID IN SO_CON
    AND FLDATE IN SO_FDATE.

  LOOP AT GT_DATA INTO GS_DATA.

    READ TABLE GT_SCARR INTO GS_SCARR
      WITH KEY CARRID = GS_DATA-CARRID.
    IF SY-SUBRC = 0.
      GS_DATA-CARRNAME = GS_SCARR-CARRNAME.
    ENDIF.
* ####, ### ##.
    GS_DATA-SEATSFREE = GS_DATA-SEATSMAX - GS_DATA-SEATSOCC.
    GS_DATA-BOOKRATE = GS_DATA-SEATSOCC / GS_DATA-SEATSMAX * 100.
    MODIFY GT_DATA FROM GS_DATA.
  ENDLOOP.
ENDFORM.
```

````ABAP
Code listing for: ZQUIZ_B13_12
Description: Program ZQUIZ_B13_12
*&---------------------------------------------------------------------*
*& Report ZQUIZ_B13_12
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZQUIZ_B13_12.

* 110# #### ##
TABLES: ZSCERTI_B13.

* ALV output.
DATA: GT_LIST TYPE TABLE OF ZSLIST_B13,
      GS_LIST LIKE LINE OF GT_LIST.

* Function code.
DATA: OK_CODE   TYPE SY-UCOMM,
      " ALV Container & ALV Grid
      GO_CONT   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV    TYPE REF TO CL_GUI_ALV_GRID,
      " ALV Layout
      GS_LAYOUT TYPE LVC_S_LAYO,
      GT_FCAT   TYPE LVC_T_FCAT,
      " MODE ## ### ### ### ### ### ###
      GV_MODE   TYPE CHAR1.

* Range var
DATA: RT_STATS TYPE RANGE OF ZTCERTI_B13-STATS,
      RS_STATS LIKE LINE OF RT_STATS,
      RT_CTYPE TYPE RANGE OF ZTCERTI_B13-CETTP,
      RS_CTYPE LIKE LINE OF RT_CTYPE,
      RT_RCVTP TYPE RANGE OF ZTCERTI_B13-RCVTP,
      RS_RCVTP LIKE LINE OF RT_RCVTP.

* Fixed value## dec ### # ##.
* Domain fixed value & text.
DATA: GT_CETTP TYPE TABLE OF DD07V,
      GS_CETTP LIKE LINE OF GT_CETTP.

DATA: GT_RCVTP TYPE TABLE OF DD07V,
      GS_RCVTP LIKE LINE OF GT_RCVTP.

DATA: GT_CETUS TYPE TABLE OF DD07V,
      GS_CETUS LIKE LINE OF GT_CETUS.

DATA: GT_STATS TYPE TABLE OF DD07V,
      GS_STATS LIKE LINE OF GT_STATS.


* Selection Screen.
*. Multiple Selection # ###. NO-EXTENSION
SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME TITLE TEXT-T10.
  SELECT-OPTIONS: SO_ADAT FOR GS_LIST-APPDT NO-EXTENSION.
*  * PARAMETERS : List Box(Dropdown Box)
  PARAMETERS: PA_STAT TYPE ZTCERTI_B13-STATS AS LISTBOX VISIBLE LENGTH 20,
              PA_CYTP TYPE ZTCERTI_B13-CETTP AS LISTBOX VISIBLE LENGTH 20,
              PA_RCVT TYPE ZTCERTI_B13-RCVTP AS LISTBOX VISIBLE LENGTH 20.
SELECTION-SCREEN END OF BLOCK BLK1.


INITIALIZATION.
* ### Default ## ## #(#) ## # ### ## ### ####
  SO_ADAT-LOW =  SY-DATUM+0(6) && '01'.
  SO_ADAT-HIGH = SY-DATUM.
  SO_ADAT-SIGN = 'I'.
  SO_ADAT-OPTION = 'BT'.
  APPEND SO_ADAT.

  PERFORM GET_DOMAIN_VALUE TABLES GT_CETTP USING 'ZDCETTP_B13'.
  PERFORM GET_DOMAIN_VALUE TABLES GT_RCVTP USING 'ZDRCVTP_B13'.
  PERFORM GET_DOMAIN_VALUE TABLES GT_CETUS USING 'ZDCETUS_B13'.
  PERFORM GET_DOMAIN_VALUE TABLES GT_STATS USING 'ZDSTATS_B13'.


START-OF-SELECTION.
  PERFORM GET_DATA.

  CALL SCREEN 100.


*&---------------------------------------------------------------------*
*& Form get_domain_value
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> GT_CETTP
*&      --> P_
*&---------------------------------------------------------------------*
FORM GET_DOMAIN_VALUE  TABLES PT_ITAB STRUCTURE DD07V
                     USING  PV_DOMAIN TYPE DD07V-DOMNAME.

  CALL FUNCTION 'GET_DOMAIN_VALUES'
    EXPORTING
      DOMNAME         = PV_DOMAIN
    TABLES
      VALUES_TAB      = PT_ITAB
    EXCEPTIONS
      NO_VALUES_FOUND = 1
      OTHERS          = 2.
  IF SY-SUBRC <> 0.
* Implement suitable error handling here
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
    WHEN 'CRT'.
      CLEAR: GV_MODE.
      CALL SCREEN 110
         STARTING AT 5 5.
    WHEN 'CHG'.
      GV_MODE = 'C'.
      PERFORM SELECTED_ROW.
      CALL SCREEN 110
        STARTING AT 5 5.
    WHEN 'DEL'.
      PERFORM CANCEL_APPLICATION.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV OUTPUT.
  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
        CONTAINER_NAME = 'AREA'.

    CREATE OBJECT GO_ALV
      EXPORTING
        I_PARENT = GO_CONT.

*    ALV Grid Layout ####
    GS_LAYOUT-ZEBRA = 'X'.
    GS_LAYOUT-CWIDTH_OPT = 'X'.

    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT                     = GS_LAYOUT
*        Local Structure# # # ##.
        I_STRUCTURE_NAME              = 'ZSLIST_B13'           " Internal Output Table Structure Name
      CHANGING
        IT_OUTTAB                     = GT_LIST
*       IT_FIELDCATALOG               = GT_FCAT.
      EXCEPTIONS
        INVALID_PARAMETER_COMBINATION = 1
        PROGRAM_ERROR                 = 2
        TOO_MANY_LINES                = 3
        OTHERS                        = 4.
  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0110 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0110 OUTPUT.
  SET PF-STATUS 'S110'.
  SET TITLEBAR 'T110'.
*  ## ## ### ## ### ### ##. ### ## ##.
  IF GV_MODE = 'C'.
    SET TITLEBAR 'T110' WITH TEXT-C01. " ##
  ELSE.
    SET TITLEBAR 'T110' WITH TEXT-C02. " ##
  ENDIF.

ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OKCODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OKCODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0110  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0110 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
    WHEN 'SAVE'.
      PERFORM SAVE_CETI.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module MODIFY_SCREEN_110 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE MODIFY_SCREEN_110 OUTPUT.
*  ## ## ### ## ## output ## ##
  IF GV_MODE = 'C'.
    LOOP AT SCREEN.
      IF SCREEN-NAME = 'ZSCERTI_B13-PERNR'.
        SCREEN-INPUT = 0.
        MODIFY SCREEN.
      ENDIF.
    ENDLOOP.
  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Form SAVE_CETI
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SAVE_CETI .
  DATA: LS_ZTCERTI_B13 TYPE ZTCERTI_B13.
  MOVE-CORRESPONDING ZSCERTI_B13 TO LS_ZTCERTI_B13.

*  ## ## (D), ## ##(P)
  CASE 'X'.
    WHEN ZSCERTI_B13-DPRNT.
      LS_ZTCERTI_B13-RCVTP = 'D'.
    WHEN ZSCERTI_B13-POSTR.
      LS_ZTCERTI_B13-RCVTP = 'P'.
    WHEN OTHERS.
  ENDCASE.

*  ## ## = ## ##
  LS_ZTCERTI_B13-APPDT = SY-DATUM.

  IF GV_MODE IS INITIAL.
    LS_ZTCERTI_B13-STATS = 'A'.

*   #### ##.
    CALL FUNCTION 'NUMBER_GET_NEXT'
      EXPORTING
        NR_RANGE_NR             = '01'
        OBJECT                  = 'ZCERTI_00'
      IMPORTING
        NUMBER                  = LS_ZTCERTI_B13-APPNO
      EXCEPTIONS
        INTERVAL_NOT_FOUND      = 1
        NUMBER_RANGE_NOT_INTERN = 2
        OBJECT_NOT_FOUND        = 3
        QUANTITY_IS_0           = 4
        QUANTITY_IS_NOT_1       = 5
        INTERVAL_OVERFLOW       = 6
        BUFFER_OVERFLOW         = 7
        OTHERS                  = 8.
    IF SY-SUBRC <> 0.
* Implement suitable error handling here
    ENDIF.

* #### #### ####.
    INSERT ZTCERTI_B13 FROM LS_ZTCERTI_B13.
    IF SY-SUBRC = 0.
      PERFORM GET_DATA.
      PERFORM REFRESH_ALV.
      LEAVE TO SCREEN 0.
      MESSAGE 'Success, Date Save' TYPE 'S'.
    ENDIF.
  ELSE.
    UPDATE ZTCERTI_B13 FROM LS_ZTCERTI_B13.
    IF SY-SUBRC = 0.
      PERFORM GET_DATA.
      PERFORM REFRESH_ALV.
      LEAVE TO SCREEN 0.
      MESSAGE 'Success, Date Save' TYPE 'S'.
    ELSE.
      MESSAGE 'Error, Data Save' TYPE 'E'.
    ENDIF.
    MESSAGE 'Error, Data Save' TYPE 'E'.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form GET_DATA
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM GET_DATA .

* ### ### #####
  IF PA_STAT IS NOT INITIAL.
*   ###### ### #### RANGE ### ####.
    RS_STATS-SIGN = 'I'.
    RS_STATS-OPTION = 'EQ'.
    RS_STATS-LOW = PA_STAT.
    APPEND RS_STATS TO RT_STATS.
  ENDIF.

  IF PA_RCVT IS NOT INITIAL.
*   ###### ### #### RANGE ### ####.
    RS_RCVTP-SIGN = 'I'.
    RS_RCVTP-OPTION = 'EQ'.
    RS_RCVTP-LOW = PA_RCVT.
    APPEND RS_RCVTP TO RT_RCVTP.
  ENDIF.

  IF PA_CYTP IS NOT INITIAL.
*   ###### ### #### RANGE ### ####.
    RS_CTYPE-SIGN = 'I'.
    RS_CTYPE-OPTION = 'EQ'.
    RS_CTYPE-LOW = PA_CYTP.
    APPEND RS_CTYPE TO RT_CTYPE.
  ENDIF.

  SELECT B~APPNO B~APPDT B~PERNR A~ENAME
         B~CETTP B~REQNR B~RCVTP B~CETUS B~STATS
    " ## ### # #### TABLE# ## ENDSELECT# ### ###.
    INTO CORRESPONDING FIELDS OF TABLE GT_LIST
    FROM ZEMP_B01 AS A INNER JOIN ZTCERTI_B13 AS B ON A~PERNR = B~PERNR
    WHERE APPDT IN SO_ADAT
     AND CETTP IN RT_CTYPE
     AND RCVTP IN RT_RCVTP
     AND STATS IN RT_STATS.

  LOOP AT GT_LIST INTO GS_LIST.
    READ TABLE GT_CETTP INTO GS_CETTP
      WITH KEY DOMVALUE_L = GS_LIST-CETTP.

    IF SY-SUBRC = 0.
      GS_LIST-CETNM = GS_CETTP-DDTEXT.
    ENDIF.

    READ TABLE GT_RCVTP INTO GS_RCVTP
        WITH KEY DOMVALUE_L = GS_LIST-RCVTP.

    IF SY-SUBRC = 0.
      GS_LIST-RCVTX = GS_RCVTP-DDTEXT.
    ENDIF.

    READ TABLE GT_CETUS INTO GS_CETUS
      WITH KEY DOMVALUE_L = GS_LIST-CETUS.

    IF SY-SUBRC = 0.
      GS_LIST-CETTX = GS_CETTP-DDTEXT.
    ENDIF.

    READ TABLE GT_STATS INTO GS_STATS
      WITH KEY DOMVALUE_L = GS_LIST-STATS.

    IF SY-SUBRC = 0.
      GS_LIST-STATX = GS_STATS-DDTEXT.
    ENDIF.

    MODIFY GT_LIST FROM GS_LIST.
    CLEAR: GS_LIST.
  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form REFRESH_ALV
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM REFRESH_ALV .
  CALL METHOD GO_ALV->REFRESH_TABLE_DISPLAY
    EXCEPTIONS
      FINISHED = 1                " Display was Ended (by Export)
      OTHERS   = 2.
  IF SY-SUBRC <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*     WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form SELECTED_ROW
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SELECTED_ROW .
  DATA: LT_ROW TYPE LVC_T_ROID,
        LS_ROW TYPE LVC_S_ROID.

  CALL METHOD GO_ALV->GET_SELECTED_ROWS
    IMPORTING
      ET_ROW_NO = LT_ROW.

*   ### Row# ## ##.
  IF LT_ROW IS INITIAL.
    MESSAGE 'Data(Row)# #### ###!' TYPE 'I'.
  ELSE.
    READ TABLE LT_ROW INTO LS_ROW INDEX 1.

    READ TABLE GT_LIST INTO GS_LIST INDEX LS_ROW-ROW_ID.

*   ### ### A(##) # ## ## ##, ### ###.
    IF GS_LIST-STATS = 'A'.
      CLEAR: ZSCERTI_B13.
      MOVE-CORRESPONDING GS_LIST TO ZSCERTI_B13.

*   ## ### ## ## D# ## ## ## ### ##
*   P # ## ## ## ### ##.
      CASE GS_LIST-RCVTP.
        WHEN 'D'.
          ZSCERTI_B13-DPRNT = 'X'.
        WHEN 'P'.
          ZSCERTI_B13-POSTR = 'X'.
        WHEN OTHERS.
          CALL SCREEN 110
   STARTING AT 5 5.
      ENDCASE.
    ELSE.
      MESSAGE '### ## # # ####!' TYPE 'I'.
    ENDIF.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form CANCEL_APPLICATION
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM CANCEL_APPLICATION .
  DATA: LT_ROW TYPE LVC_T_ROID,
        LS_ROW TYPE LVC_S_ROID.

  CALL METHOD GO_ALV->GET_SELECTED_ROWS
    IMPORTING
      ET_ROW_NO = LT_ROW.

  IF LT_ROW IS INITIAL.
    MESSAGE 'DATA(ROW)# #### ###' TYPE 'I'.
  ELSE.

  ENDIF.
ENDFORM.

````

```ABAP
Code listing for: ZQUIZ_B13_06
Description: Report ZQUIZ_B13_05
REPORT ZQUIZ_B13_06.

* ##### #### ##
DATA: OK_CODE TYPE SY-UCOMM,
      GO_CONT TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV  TYPE REF TO CL_GUI_ALV_GRID,
      GS_LAYOUT  TYPE LVC_S_LAYO.

*  #### ### ##
DATA: GT_SCARR   TYPE TABLE OF SCARR,
      GT_SBOOK   TYPE TABLE OF SBOOK,
      GT_SFLIGHT TYPE TABLE OF SFLIGHT,
      GS_SCARR   LIKE LINE OF GT_SCARR,
      GS_SBOOK   LIKE LINE OF GT_SBOOK,
      GS_SFLIGHT LIKE LINE OF GT_SFLIGHT.

TYPES: BEGIN OF TS_DATA.
         include structure ZSC_ZQUIZ_B13_06.
TYPES:   EXCP   TYPE CHAR1,
         COLOR  TYPE CHAR4,
         IT_COL TYPE LVC_T_SCOL,
       END OF TS_DATA.

DATA: LT_DATA TYPE TABLE OF TS_DATA,
      LS_DATA LIKE LINE OF LT_DATA.

*DATA: LT_DATA TYPE TABLE OF ZSC_ZQUIZ_B13_06,
*      LS_DATA TYPE ZSC_ZQUIZ_B13_06.

SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME.
  SELECT-OPTIONS: SO_CAR FOR GS_SFLIGHT-CARRID,
                  SO_CON FOR GS_SBOOK-CONNID.
SELECTION-SCREEN END OF BLOCK BLK1.

INITIALIZATION.

  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'EQ'.
  SO_CAR-LOW = 'AA'.
  SO_CAR-HIGH = 'DL'.
  APPEND SO_CAR.

START-OF-SELECTION.
* ### # ####
  SELECT * INTO TABLE GT_SCARR FROM SCARR.

* #### ### ### SELECT ###
  SELECT *
    FROM SFLIGHT
    INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT
    WHERE CARRID IN SO_CAR
    AND CONNID IN SO_CON.


  LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.
*   Read Table # #### ### ## ####
    READ TABLE GT_SCARR INTO GS_SCARR
    WITH KEY CARRID = GS_SFLIGHT-CARRID.
    IF SY-SUBRC = 0.
      LS_DATA-CARRNAME = GS_SCARR-CARRNAME.
    ENDIF.

    LS_DATA-CONNID = GS_SFLIGHT-CONNID.
    LS_DATA-CARRID = GS_SFLIGHT-CARRID.
    LS_DATA-FLDATE = GS_SFLIGHT-FLDATE.

*     ###
*    SFLIGHT ##### ####(SEATSMAX), ####(SEATSMAX_B), ###(SEATSMAX_F) 3 ## ###
*    ##### 3 ## ### ## ## ## #### ####.
*    - ## ###
*    SFLIGHT ##### ####(SEATSOCC), ####(SEATSOCC_B), ###(SEATSOCC_F) 3 ## ###
*    ##### 3 ## ### ## ## ## ## #### ####.
*    - ## ### = SEATSMAX Ã± SEATSOCC

    LS_DATA-SEATSMAX = GS_SFLIGHT-SEATSMAX +
                         GS_SFLIGHT-SEATSMAX_B +
                         GS_SFLIGHT-SEATSMAX_F.

    LS_DATA-SEATSOCC = GS_SFLIGHT-SEATSOCC +
                         GS_SFLIGHT-SEATSOCC_B +
                         GS_SFLIGHT-SEATSOCC_F.

    LS_DATA-SEATSDIF = LS_DATA-SEATSMAX -
                         LS_DATA-SEATSOCC.

* PRIVATE, BUSINESS ## #
* ### ## ###(SBOOK)## CUSTTYPE ### ####, ###### B(BUSINESS), P(PRIVATE)##
* ####

    SELECT COUNT( * )
    FROM SBOOK
    INTO LS_DATA-PRIVATE
    WHERE CARRID = GS_SFLIGHT-CARRID
      AND CONNID = GS_SFLIGHT-CONNID
      AND FLDATE = GS_SFLIGHT-FLDATE
      AND CUSTTYPE = 'P'
      AND CANCELLED = ' '.

    SELECT COUNT( * )
      FROM SBOOK
      INTO LS_DATA-BUSINESS
      WHERE CARRID = GS_SFLIGHT-CARRID
        AND CONNID = GS_SFLIGHT-CONNID
        AND FLDATE = GS_SFLIGHT-FLDATE
        AND CUSTTYPE = 'B'
        AND CANCELLED = ' '.

* ## #### 20 # ###### ##### ##
    DATA: LS_SCOL TYPE LVC_S_SCOL.

    IF LS_DATA-SEATSDIF <= 20.
      LS_SCOL-FNAME = 'SEATSDIF'.
      LS_SCOL-COLOR-COL = '6'.
      LS_SCOL-COLOR-INT = '1'.
      LS_SCOL-COLOR-INV = '0'.
      APPEND LS_SCOL TO LS_DATA-IT_COL.
    ENDIF.

    APPEND LS_DATA TO LT_DATA.
    CLEAR: LS_DATA.
  ENDLOOP.

  CALL SCREEN 100.
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OK_CODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV OUTPUT.
  GS_LAYOUT-INFO_FNAME = 'COLOR'.
  GS_LAYOUT-CTAB_FNAME = 'IT_COL'.
  GS_LAYOUT-STYLEFNAME = 'IT_BTN'.
  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
        CONTAINER_NAME = 'AREA'.

    CREATE OBJECT GO_ALV
      EXPORTING
        I_PARENT = GO_CONT.

    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT                     = GS_LAYOUT
*        Local Structure# # # ##.
        I_STRUCTURE_NAME = 'ZSC_ZQUIZ_B13_06'           " Internal Output Table Structure Name
      CHANGING
        IT_OUTTAB        = LT_DATA.
  ENDIF.
ENDMODULE.
```

```ABAP
Code listing for: ZQUIZ_B13_07
Description: Report ZQUIZ_B13_05
REPORT ZQUIZ_B13_07.

* ### ## ### ### ### ##### ####

* ##### #### ##
DATA: OK_CODE   TYPE SY-UCOMM,
      GO_CONT   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV    TYPE REF TO CL_GUI_ALV_GRID,
      GS_LAYOUT TYPE LVC_S_LAYO,

      GT_FCAT   TYPE LVC_T_FCAT.

* 200# ### ALV# ##
DATA: GO_CONT2   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV2    TYPE REF TO CL_GUI_ALV_GRID,
      GS_LAYOUT2 TYPE LVC_S_LAYO.

TYPES: BEGIN OF TS_DATA2.
         INCLUDE TYPE SBOOK.
TYPES:   EXCP  TYPE CHAR1,
         COLOR TYPE CHAR4,
       END OF TS_DATA2.

*  DB Table : SCUSTOM, SBOOK
DATA: GT_SCUSTOM TYPE TABLE OF SCUSTOM,
      GT_SBOOK   TYPE TABLE OF TS_DATA2,
      GS_SCUSTOM LIKE LINE OF GT_SCUSTOM,
      GS_SBOOK   LIKE LINE OF GT_SBOOK.

TYPES: BEGIN OF TS_DATA.
         include structure ZSC_ZQUIZ_B13_07.
TYPES:   EXCP   TYPE CHAR1,
         COLOR  TYPE CHAR4,
         IT_COL TYPE LVC_T_SCOL,
       END OF TS_DATA.

DATA: GT_DATA  TYPE TABLE OF TS_DATA,
      GS_DATA  LIKE LINE OF GT_DATA,
      GT_DATA2 TYPE TABLE OF TS_DATA2.

CONSTANTS: GC_MARK TYPE CHAR1 VALUE 'X'.

* CLASS #### ## ## ### ##. ### ##
* Hotspot Click Event # #### ## ### ### #### ALV # ####
* ##(Grage) Hotspot ### ####.
CLASS LCL_EVENT_HANDLER DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      ON_HOTSPOT_CLICK FOR EVENT HOTSPOT_CLICK  OF CL_GUI_ALV_GRID
        IMPORTING ES_ROW_NO E_COLUMN_ID.
ENDCLASS.


CLASS LCL_EVENT_HANDLER IMPLEMENTATION.
  METHOD ON_HOTSPOT_CLICK.
    IF E_COLUMN_ID-FIELDNAME = 'CLASS'.
      READ TABLE GT_DATA INTO GS_DATA INDEX ES_ROW_NO-ROW_ID.

      SELECT *
        FROM SBOOK
        INTO CORRESPONDING FIELDS OF TABLE GT_SBOOK
        WHERE CUSTOMID = GS_DATA-ID.

      CALL SCREEN 200
      STARTING AT 10 10.

    ENDIF.
  ENDMETHOD.
ENDCLASS.

* Customer name ### Meier ####. (PARAMETERS)
PARAMETERS: PA_NAME TYPE SCUSTOM-NAME DEFAULT 'Meier'.

SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME.
  SELECT-OPTIONS: SO_FDATE FOR GS_SBOOK-FLDATE.
SELECTION-SCREEN END OF BLOCK BLK1.

* Radio Button # Private Customer # #### ####.
PARAMETERS: ALL      RADIOBUTTON GROUP RAG1,
            PRIVATE  RADIOBUTTON GROUP RAG1 DEFAULT 'X',
            BUSINESS RADIOBUTTON GROUP RAG1.

INITIALIZATION.
* - Flight Date # ## ### 1 # 1 ### #### ### ### ####. (SELECT-OPTIONS)
  SO_FDATE-LOW = SY-DATUM+0(4) && '0101'.
  SO_FDATE-HIGH = SY-DATUM+0(4) && '1231'.
  APPEND SO_FDATE.

START-OF-SELECTION.

* LIKE# SQL# ### ## # ##. ### ### ### ##### ##.
  DATA: D_NAME(20).
  D_NAME = |%{ PA_NAME }%|.

* #### ### ### SELECT ###
  SELECT C~ID C~NAME B~CLASS C~POSTCODE C~CITY C~STREET C~COUNTRY
    C~TELEPHONE B~CUSTTYPE C~FORM
    FROM SCUSTOM AS C INNER JOIN SBOOK AS B
    ON C~ID = B~CUSTOMID
    INTO CORRESPONDING FIELDS OF TABLE GT_DATA
    WHERE C~NAME LIKE D_NAME
    AND B~FLDATE BETWEEN SO_FDATE-LOW AND SO_FDATE-HIGH.


  LOOP AT GT_DATA INTO GS_DATA.

* #### ## ## #### ## ##.
    IF ALL = 'X'.
*  ## ## ##.
      SELECT COUNT( * )
      FROM SBOOK
      INTO GS_DATA-RESERVED
      WHERE FLDATE IN SO_FDATE
       AND CUSTOMID = GS_DATA-ID
        AND CANCELLED = ' '.
    ELSEIF PRIVATE = 'X'.
*  ## ### P # ##.
      SELECT COUNT( * )
       FROM SBOOK
       INTO GS_DATA-RESERVED
       WHERE FLDATE BETWEEN SO_FDATE-LOW AND SO_FDATE-HIGH
        AND CUSTOMID = GS_DATA-ID
         AND CUSTTYPE = 'P'
         AND CANCELLED = ' '.
    ELSE.
*  ## ### B # ##.
      SELECT COUNT( * )
       FROM SBOOK
       INTO GS_DATA-RESERVED
       WHERE FLDATE BETWEEN SO_FDATE-LOW AND SO_FDATE-HIGH
        AND CUSTOMID = GS_DATA-ID
         AND CUSTTYPE = 'B'
         AND CANCELLED = ' '.
    ENDIF.


*  # ### ## ### 20 #### ##(Silver), 20 ## 50 ## ## ##(Gold),
* 50 #### ####(Platinum

    IF GS_DATA-RESERVED < 20.
      GS_DATA-EXCP = '1'.
    ELSEIF GS_DATA-RESERVED >= 20 AND GS_DATA-RESERVED < 50.
      GS_DATA-EXCP = '2'.
    ELSE.
      GS_DATA-EXCP = '3'.
    ENDIF.

*# ## ### Business Customer ## ## ### #### ####.

    MODIFY GT_DATA FROM GS_DATA.
    CLEAR: GS_DATA.

  ENDLOOP.
  CALL SCREEN 100.
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OK_CODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*

MODULE INIT_ALV OUTPUT.

  GS_LAYOUT-SEL_MODE = 'D'.
  GS_LAYOUT-EXCP_FNAME = 'EXCP'.
  GS_LAYOUT-EXCP_LED = 'X'.
  GS_LAYOUT-INFO_FNAME = 'COLOR'.
  GS_LAYOUT-CTAB_FNAME = 'IT_COL'.
  DATA: LS_FCAT TYPE LVC_S_FCAT.

  LS_FCAT-FIELDNAME = 'CLASS'.
  LS_FCAT-COL_POS = 7.
  LS_FCAT-HOTSPOT = 'X'.

  APPEND LS_FCAT TO GT_FCAT.
  CLEAR: LS_FCAT.

  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
        CONTAINER_NAME = 'AREA'.

    CREATE OBJECT GO_ALV
      EXPORTING
        I_PARENT = GO_CONT.

    SET HANDLER LCL_EVENT_HANDLER=>ON_HOTSPOT_CLICK FOR GO_ALV.

    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT        = GS_LAYOUT
*        Local Structure# # # ##.
        I_STRUCTURE_NAME = 'ZSC_ZQUIZ_B13_07'           " Internal Output Table Structure Name
      CHANGING
        IT_OUTTAB        = GT_DATA
        IT_FIELDCATALOG  = GT_FCAT.
  ENDIF.
ENDMODULE.

*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0110  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0110 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV2 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV2 OUTPUT.

  LOOP AT GT_SBOOK INTO GS_SBOOK.
    IF GS_SBOOK-CUSTTYPE = 'B'.
      GS_SBOOK-COLOR = 'C300'.
    ENDIF.

    MODIFY GT_SBOOK FROM GS_SBOOK.
    CLEAR: GS_SBOOK.
  ENDLOOP.

  GS_LAYOUT2-INFO_FNAME = 'COLOR'.

  IF GO_CONT2 IS INITIAL.
    CREATE OBJECT GO_CONT2
      EXPORTING
        CONTAINER_NAME = 'AREA2'.

    CREATE OBJECT GO_ALV2
      EXPORTING
        I_PARENT = GO_CONT2.

    CALL METHOD GO_ALV2->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT        = GS_LAYOUT2
*        Local Structure# # # ##.
        I_STRUCTURE_NAME = 'SBOOK'           " Internal Output Table Structure Name
      CHANGING
        IT_OUTTAB        = GT_SBOOK.
  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0200 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0200 OUTPUT.
  SET PF-STATUS 'S200'.
ENDMODULE.

```

```ABAP
Code listing for: ZQUIZ_B13_08_03
Description: Quiz 08_03 Field Symbol
*&---------------------------------------------------------------------*
*& Report ZQUIZ_B00_08_03
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZQUIZ_B13_08_03.

DATA: BEGIN OF GS_SUM,
        CARRID   TYPE SFLIGHT-CARRID,
        CURRENCY TYPE SFLIGHT-CURRENCY,
        TOTAL    TYPE SFLIGHT-PAYMENTSUM,
      END OF GS_SUM,
      GT_SUM LIKE TABLE OF GS_SUM.

DATA: GV_SUBRC TYPE SY-SUBRC.

DATA: BEGIN OF GS_DATA,
        CARRID   TYPE SFLIGHT-CARRID,
        CARRNAME TYPE SCARR-CARRNAME,
        CURRENCY TYPE SFLIGHT-CURRENCY,
        MON01    TYPE SFLIGHT-PAYMENTSUM,
        MON02    TYPE SFLIGHT-PAYMENTSUM,
        MON03    TYPE SFLIGHT-PAYMENTSUM,
        MON04    TYPE SFLIGHT-PAYMENTSUM,
        MON05    TYPE SFLIGHT-PAYMENTSUM,
        MON06    TYPE SFLIGHT-PAYMENTSUM,
        MON07    TYPE SFLIGHT-PAYMENTSUM,
        MON08    TYPE SFLIGHT-PAYMENTSUM,
        MON09    TYPE SFLIGHT-PAYMENTSUM,
        MON10    TYPE SFLIGHT-PAYMENTSUM,
        MON11    TYPE SFLIGHT-PAYMENTSUM,
        MON12    TYPE SFLIGHT-PAYMENTSUM,
      END OF GS_DATA,
      GT_DATA LIKE TABLE OF GS_DATA.

DATA: BEGIN OF GS_YEAR,
        KEY   TYPE NUM4,
        VALUE TYPE CHAR10,
      END OF GS_YEAR,
      GT_YEAR LIKE TABLE OF GS_YEAR.

DATA: GV_MON   TYPE STRING,
      GV_INDEX TYPE NUM02.

DATA: GT_SCARR TYPE TABLE OF SCARR,
      GS_SCARR LIKE LINE OF GT_SCARR.

DATA: GV_FNAME TYPE STRING.

DATA: GO_SALV TYPE REF TO CL_SALV_TABLE.

FIELD-SYMBOLS: <FS_COMP> TYPE SFLIGHT-PAYMENTSUM.

PARAMETERS: PA_YEAR TYPE CHAR4.

*SELECT-OPTIONS: SO_CAR FOR GS_DATA-CARRID NO-DISPLAY.

INITIALIZATION.
  PA_YEAR = SY-DATUM(4).

  DO 5 TIMES.
    GS_YEAR-KEY = SY-DATUM(4).
    GS_YEAR-VALUE = GS_YEAR-KEY && '##'.
    APPEND GS_YEAR TO GT_YEAR.
    ADD 1 TO SY-DATUM(4).
  ENDDO.

  SELECT *
    INTO TABLE GT_SCARR
    FROM SCARR.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR PA_YEAR.

  CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      RETFIELD        = 'PA_YEAR'
      DYNPPROG        = SY-REPID
      DYNPNR          = SY-DYNNR
      DYNPROFIELD     = 'KEY'
      VALUE_ORG       = 'S'
    TABLES
      VALUE_TAB       = GT_YEAR
    EXCEPTIONS
      PARAMETER_ERROR = 1
      NO_VALUES_FOUND = 2
      OTHERS          = 3.

START-OF-SELECTION.

  DO 12 TIMES.
    GV_INDEX = SY-INDEX.
    GV_MON = PA_YEAR && GV_INDEX && '%'.

    SELECT  CARRID CURRENCY SUM( PAYMENTSUM ) AS TOTAL
      INTO CORRESPONDING FIELDS OF TABLE GT_SUM
      FROM SFLIGHT
*      WHERE CARRID IN SO_CAR
       WHERE FLDATE LIKE GV_MON
      GROUP BY CARRID CURRENCY.

    SORT GT_SUM BY CARRID.

    LOOP AT GT_SUM INTO GS_SUM.
      READ TABLE GT_DATA INTO GS_DATA WITH KEY CARRID = GS_SUM-CARRID.
      GV_SUBRC = SY-SUBRC.

      GV_FNAME = 'GS_DATA-MON' && GV_INDEX.
      ASSIGN (GV_FNAME) TO <FS_COMP>.
      <FS_COMP> = GS_SUM-TOTAL.

      IF GV_SUBRC <> 0.
        MOVE-CORRESPONDING GS_SUM TO GS_DATA.
        READ TABLE GT_SCARR INTO GS_SCARR
          WITH KEY CARRID = GS_SUM-CARRID.
        IF SY-SUBRC = 0.
          GS_DATA-CARRNAME = GS_SCARR-CARRNAME.
        ENDIF.

        APPEND GS_DATA TO GT_DATA.
      ELSE.
        MODIFY GT_DATA FROM GS_DATA INDEX SY-TABIX.
      ENDIF.
      CLEAR: GS_SUM, GV_SUBRC, GS_DATA.
    ENDLOOP.

  ENDDO.

  CALL METHOD CL_SALV_TABLE=>FACTORY
    IMPORTING
      R_SALV_TABLE = GO_SALV
    CHANGING
      T_TABLE      = GT_DATA.

  GO_SALV->DISPLAY( ).
```

```ABAP
Code listing for: ZHA400_B13_NEW_OSQL
Description: Template: Use Enhanced Open SQL
*&---------------------------------------------------------------------*
*& Report  HA400_CDS_VIEW_S1
*&
*&---------------------------------------------------------------------*
*&
*&
*&---------------------------------------------------------------------*
REPORT ZHA400_B13_NEW_OSQL MESSAGE-ID HA400.

* Structure for Result
TYPES: BEGIN OF TY_S_CARRIER,
         CARRID           TYPE SCARR-CARRID,
         CARRNAME         TYPE SCARR-CARRNAME,
         CURRCODE         TYPE SCARR-CURRCODE,
         REVENUE_FIRST    TYPE HA400_REVFST,
         REVENUE_BUSINESS TYPE HA400_REVBUS,
         REVENUE_ECONOMY  TYPE HA400_REVECO,
       END OF TY_S_CARRIER.

TYPES: TY_T_CARRIERS TYPE STANDARD TABLE OF TY_S_CARRIER
                       WITH NON-UNIQUE KEY CARRID.

* Data objects
DATA: GT_CARRIERS   TYPE TY_T_CARRIERS,
      GT_CARRIERS_T LIKE GT_CARRIERS.

* Database connection
DATA GV_DBCON TYPE DBCON-CON_NAME.
CONSTANTS:
  C_PRIMDB TYPE DBCON-CON_NAME VALUE 'DEFAULT',
  C_SECDB  TYPE DBCON-CON_NAME VALUE 'DEFAULT'.

* selection screen
SELECTION-SCREEN BEGIN OF BLOCK EXE WITH FRAME TITLE TEXT-EXE.
  PARAMETERS:
    PA_TEMP TYPE XFELD RADIOBUTTON GROUP EXE DEFAULT 'X',
    PA_SOLU TYPE XFELD RADIOBUTTON GROUP EXE,
    PA_BOTH TYPE XFELD RADIOBUTTON GROUP EXE.
SELECTION-SCREEN END OF BLOCK EXE.

SELECTION-SCREEN BEGIN OF BLOCK DBC WITH FRAME TITLE TEXT-DBC.
  PARAMETERS:
    PA_PRIM TYPE XFELD RADIOBUTTON GROUP DBC,
    PA_SEC  TYPE XFELD RADIOBUTTON GROUP DBC DEFAULT 'X'.
SELECTION-SCREEN END OF BLOCK DBC.

START-OF-SELECTION.

  CASE 'X'.
    WHEN PA_PRIM.
      GV_DBCON = C_PRIMDB.
    WHEN PA_SEC.
      GV_DBCON = C_SECDB.
  ENDCASE.

  CASE 'X'.
    WHEN PA_TEMP.  " template only
      PERFORM GET_DATA_TEMPLATE USING    GV_DBCON
                                CHANGING GT_CARRIERS_T.
      PERFORM DISPLAY USING GT_CARRIERS_T.
    WHEN PA_SOLU.  " solution only
      PERFORM GET_DATA_SOLUTION USING    GV_DBCON
                                CHANGING GT_CARRIERS.
      PERFORM DISPLAY USING GT_CARRIERS.
    WHEN PA_BOTH.  " both subroutines
      PERFORM GET_DATA_SOLUTION USING    GV_DBCON
                                CHANGING GT_CARRIERS.
      PERFORM GET_DATA_TEMPLATE USING    GV_DBCON
                                CHANGING GT_CARRIERS_T.
      IF GT_CARRIERS <> GT_CARRIERS_T.
        MESSAGE I010.
      ELSE.
        MESSAGE S011.
      ENDIF.
  ENDCASE.

*&---------------------------------------------------------------------*
*&      Form  get_data_template
*&---------------------------------------------------------------------*
FORM GET_DATA_TEMPLATE    USING PV_DBCON     TYPE DBCON-CON_NAME
                       CHANGING CT_CARRIERS TYPE TY_T_CARRIERS.

*  TYPES: BEGIN OF TY_S_SCARR,
*           CARRID   TYPE SCARR-CARRID,
*           CARRNAME TYPE SCARR-CARRNAME,
*           CURRCODE TYPE SCARR-CURRCODE,
*         END OF TY_S_SCARR.
*  TYPES: BEGIN OF TY_S_SBOOK,
*           CARRID    TYPE SBOOK-CARRID,
*           CLASS     TYPE SBOOK-CLASS,
*           LOCCURKEY TYPE SBOOK-LOCCURKEY,
*           LOCCURAM  TYPE SBOOK-LOCCURAM,
*         END OF TY_S_SBOOK.
*
*  DATA LS_CARRIER TYPE TY_S_CARRIER.
*
*  DATA: LT_SCARR TYPE SORTED TABLE OF TY_S_SCARR
*                      WITH UNIQUE KEY CARRID,
*        LS_SCARR TYPE TY_S_SCARR.
*
*  DATA: LT_SBOOK TYPE SORTED TABLE OF TY_S_SBOOK
*                      WITH NON-UNIQUE KEY CARRID,
*        LS_SBOOK TYPE TY_S_SBOOK.


  SELECT FROM SCARR AS C LEFT OUTER JOIN SBOOK AS B ON C~CARRID = B~CARRID
    FIELDS C~CARRID, C~CARRNAME, C~CURRCODE,
    SUM( CASE B~CLASS WHEN 'F' THEN B~LOCCURAM ELSE 0 END ) AS REVENUE_FIRST,
    SUM( CASE B~CLASS WHEN 'C' THEN B~LOCCURAM ELSE 0 END ) AS REVENUE_BUSINESS,
    SUM( CASE B~CLASS WHEN 'Y' THEN B~LOCCURAM ELSE 0 END ) AS REVENUE_ECONOMY
    WHERE B~CANCELLED <> 'X'
    GROUP BY C~CARRID, C~CARRNAME, C~CURRCODE
    INTO TABLE @CT_CARRIERS.


* Classic Open SQL
*SELECT CARRID CARRNAME CURRCODE
*  FROM SCARR
*  CONNECTION (PV_DBCON)
*  INTO TABLE LT_SCARR.
*
*SELECT CARRID CLASS LOCCURKEY LOCCURAM
*  FROM SBOOK
*  CONNECTION (PV_DBCON)
*  INTO TABLE LT_SBOOK
*   WHERE CANCELLED <> 'X'.
*
*LOOP AT LT_SCARR INTO LS_SCARR.
*  CLEAR LS_CARRIER.
*
*  LOOP AT LT_SBOOK INTO LS_SBOOK
*                   WHERE CARRID = LS_SCARR-CARRID.
*    IF LS_SBOOK-LOCCURKEY <> LS_SCARR-CURRCODE.
*      MESSAGE 'Inconsistent data' TYPE 'A'.
*    ENDIF.
*    CASE LS_SBOOK-CLASS.
*      WHEN 'F'.  "First Class Booking
*        LS_CARRIER-REVENUE_FIRST =         LS_CARRIER-REVENUE_FIRST
*                                         + LS_SBOOK-LOCCURAM.
*      WHEN 'C'. "Business Class Booking
*        LS_CARRIER-REVENUE_BUSINESS =      LS_CARRIER-REVENUE_BUSINESS
*                                         + LS_SBOOK-LOCCURAM.
*      WHEN 'Y'.  "Economy Class Booking
*        LS_CARRIER-REVENUE_ECONOMY =       LS_CARRIER-REVENUE_ECONOMY
*                                         + LS_SBOOK-LOCCURAM.
*    ENDCASE.
*  ENDLOOP.
*  MOVE-CORRESPONDING LS_SCARR TO LS_CARRIER.
*  APPEND LS_CARRIER TO CT_CARRIERS.
*ENDLOOP.

ENDFORM.                    "
*&---------------------------------------------------------------------*
*&      Form  get_data_solution
*&---------------------------------------------------------------------*
FORM GET_DATA_SOLUTION    USING PV_DBCON     TYPE DBCON-CON_NAME
                       CHANGING CT_CARRIERS TYPE TY_T_CARRIERS.

*  SELECT a~carrid a~carrname a~currcode
*      SUM( b~loccuram ) AS revenue_first    "Sum only bookings with class = 'F'
*      SUM( b~loccuram ) AS revenue_business "Sum only bookings with class = 'C'
*      SUM( b~loccuram ) AS revenue_economy  "Sum only bookings with class = 'Y'
*    FROM scarr AS a LEFT OUTER JOIN sbook AS b
*            ON a~carrid = b~carrid
*    INTO TABLE ct_carriers
*    CONNECTION (pv_dbcon)
*    WHERE b~cancelled <> 'X' OR b~cancelled IS NULL
*  GROUP BY a~carrid a~carrname a~currcode
*  ORDER BY a~carrid.

ENDFORM.                    "

*&---------------------------------------------------------------------*
*&      Form  output
*&---------------------------------------------------------------------*

FORM DISPLAY USING PT_CARRIERS TYPE TY_T_CARRIERS.

  DATA: LO_ALV  TYPE REF TO CL_SALV_TABLE,
        LX_MSG  TYPE REF TO CX_SALV_MSG,
        LV_TEXT TYPE STRING.

* display
  TRY.
      CL_SALV_TABLE=>FACTORY(
          IMPORTING
            R_SALV_TABLE = LO_ALV
          CHANGING
            T_TABLE      = PT_CARRIERS ).

      LO_ALV->DISPLAY( ).

    CATCH CX_SALV_MSG INTO LX_MSG.
      LV_TEXT = LX_MSG->GET_TEXT( ).
      MESSAGE LV_TEXT TYPE 'E'.
  ENDTRY.

ENDFORM.                    "display

```

```ABAP
*&---------------------------------------------------------------------*
*& Include          ZBC405_B13_25_TOP
*&---------------------------------------------------------------------*

TYPE-POOLS : COL, ICON.

TYPES: BEGIN OF GTY_FLIGHT.
         INCLUDE TYPE SFLIGHT.
TYPES:   LIGHT  TYPE CHAR1,
         COLOR  TYPE CHAR4,
         IT_COL TYPE LVC_T_SCOL,
         CH_PO  TYPE ICON-ID,
       END OF GTY_FLIGHT.

DATA: OK_CODE    TYPE SY-UCOMM,
      GT_FLIGHT  TYPE TABLE OF GTY_FLIGHT,
      GS_FLIGHT  TYPE GTY_FLIGHT,
      GO_CONT    TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV     TYPE REF TO CL_GUI_ALV_GRID,
      GS_VARIANT TYPE DISVARIANT,
      GS_LAYOUT  TYPE LVC_S_LAYO,
      GT_FCAT    TYPE LVC_T_FCAT.


SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME.
  SELECT-OPTIONS: SO_CAR FOR GS_FLIGHT-CARRID,
  SO_CON FOR GS_FLIGHT-CONNID.

  PARAMETERS: PA_VARI TYPE DISVARIANT-VARIANT.
SELECTION-SCREEN END OF BLOCK BLK1.


START-OF-SELECTION.
  PERFORM GET_DATA.

  CALL SCREEN 100.
  
  
  &---------------------------------------------------------------------*
*& Include          ZBC405_B13_25_O01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OK_CODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV OUTPUT.
  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
*       PARENT                      =
        CONTAINER_NAME              = 'MY_CONTROL_AREA'
*       STYLE                       =
*       LIFETIME                    = lifetime_default
*       REPID                       =
*       DYNNR                       =
*       NO_AUTODEF_PROGID_DYNNR     =
      EXCEPTIONS
        CNTL_ERROR                  = 1
        CNTL_SYSTEM_ERROR           = 2
        CREATE_ERROR                = 3
        LIFETIME_ERROR              = 4
        LIFETIME_DYNPRO_DYNPRO_LINK = 5
        OTHERS                      = 6.
    IF SY-SUBRC <> 0.
      MESSAGE A010(BC405_408).
    ENDIF.



    CREATE OBJECT GO_ALV
      EXPORTING
*       I_SHELLSTYLE      = 0
*       I_LIFETIME        =
        I_PARENT          = GO_CONT
*       I_APPL_EVENTS     = SPACE
*       I_PARENTDBG       =
*       I_APPLOGPARENT    =
*       I_GRAPHICSPARENT  =
*       I_NAME            =
*       I_FCAT_COMPLETE   = SPACE
*       O_PREVIOUS_SRAL_HANDLER =
      EXCEPTIONS
        ERROR_CNTL_CREATE = 1
        ERROR_CNTL_INIT   = 2
        ERROR_CNTL_LINK   = 3
        ERROR_DP_CREATE   = 4
        OTHERS            = 5.
    IF SY-SUBRC <> 0.
      MESSAGE A010(BC405_408).
    ENDIF.


    GS_VARIANT-REPORT = SY-CPROG.
    GS_VARIANT-VARIANT = PA_VARI.
    GS_LAYOUT-GRID_TITLE = 'Flight'.
    GS_LAYOUT-NO_HGRIDLN = 'X'.
    GS_LAYOUT-NO_VGRIDLN = 'X'.
    GS_LAYOUT-INFO_FNAME = 'COLOR'.
    GS_LAYOUT-CTAB_FNAME = 'IT_COL'.
    GS_LAYOUT-EXCP_FNAME = 'LIGHT'.
    GS_LAYOUT-SEL_MODE = 'A'.
    PERFORM SET_FCAT.


    SET HANDLER LCL_EVENT_HANDLER=>ON_DOUBLE_CLICK FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_TOOLBAR FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_USER_COMMAND FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_CONTEXT_MENU_REQ FOR GO_ALV.

    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
*       I_BUFFER_ACTIVE               =
*       I_BYPASSING_BUFFER            =
*       I_CONSISTENCY_CHECK           =
        I_STRUCTURE_NAME              = 'SFLIGHT'
        IS_VARIANT                    = GS_VARIANT
        I_SAVE                        = 'A'
*       I_DEFAULT                     = 'X'
        IS_LAYOUT                     = GS_LAYOUT
*       IS_PRINT                      =
*       IT_SPECIAL_GROUPS             =
*       IT_TOOLBAR_EXCLUDING          =
*       IT_HYPERLINK                  =
*       IT_ALV_GRAPHICS               =
*       IT_EXCEPT_QINFO               =
*       IR_SALV_ADAPTER               =
      CHANGING
        IT_OUTTAB                     = GT_FLIGHT
        IT_FIELDCATALOG               = GT_FCAT
*       IT_SORT                       =
*       IT_FILTER                     =
      EXCEPTIONS
        INVALID_PARAMETER_COMBINATION = 1
        PROGRAM_ERROR                 = 2
        TOO_MANY_LINES                = 3
        OTHERS                        = 4.
    IF SY-SUBRC <> 0.
      MESSAGE A012(BC405_408).
    ENDIF.

  ENDIF.

ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL'.
      LEAVE TO SCREEN 0.
    WHEN 'EXIT'.
      LEAVE PROGRAM.
  ENDCASE.

ENDMODULE.
*&---------------------------------------------------------------------*
*& Form SET_FCAT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_FCAT .
*  ## # ###?? ### ##### ####
  DATA: LS_FCAT TYPE LVC_S_FCAT.
  LS_FCAT-FIELDNAME = 'SEATSOCC'.
  LS_FCAT-DO_SUM = 'X'.
  APPEND LS_FCAT TO GT_FCAT.

* ## ###
  CLEAR  LS_FCAT.
  LS_FCAT-FIELDNAME = 'PAYMENTSUM'.
  LS_FCAT-NO_OUT = 'X'.
  APPEND LS_FCAT TO GT_FCAT.

* ### ###
  CLEAR  LS_FCAT.
  LS_FCAT-FIELDNAME = 'LIGHT'.
  LS_FCAT-COLTEXT = 'Utilization'(h02).
  APPEND LS_FCAT TO GT_FCAT.

* ## ## (#### ### ### ## ### ### ###
  CLEAR  LS_FCAT.
  LS_FCAT-FIELDNAME = 'CHANGES_POSSIBLE'.
  LS_FCAT-COL_POS = 5.
  LS_FCAT-COLTEXT = 'Changes possible'(h03).
  LS_FCAT-TOOLTIP = 'Are changes possible?'(t01).
  APPEND LS_FCAT TO GT_FCAT.


ENDFORM.


* F01
&---------------------------------------------------------------------*
*& Include          ZBC405_B13_25_F01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Form GET_DATA
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM GET_DATA .
  DATA: LS_SCOL TYPE LVC_S_SCOL.

  SELECT *
     FROM SFLIGHT
    INTO CORRESPONDING FIELDS OF TABLE GT_FLIGHT
     WHERE CARRID IN SO_CAR
     AND CONNID IN SO_CON.

  LOOP AT GT_FLIGHT INTO GS_FLIGHT.
    IF GS_FLIGHT-FLDATE(6) = SY-DATUM(6).
      GS_FLIGHT-COLOR = 'C' && COL_NEGATIVE && '01'.
    ENDIF.

    IF GS_FLIGHT-SEATSOCC = 0.
      GS_FLIGHT-LIGHT = 1.
    ELSEIF GS_FLIGHT-SEATSOCC < 50.
      GS_FLIGHT-LIGHT = 2.
    ELSE.
      GS_FLIGHT-LIGHT = 3.
    ENDIF.

    IF GS_FLIGHT-PLANETYPE = '747-400'.
      LS_SCOL-FNAME = 'PLANETYPE'.
      LS_SCOL-COLOR-COL = COL_POSITIVE.
      LS_SCOL-COLOR-INT = 1.
      LS_SCOL-COLOR-INV = 0.
      LS_SCOL-NOKEYCOL = 'X'.
      APPEND LS_SCOL TO GS_FLIGHT-IT_COL.
    ENDIF.


    IF GS_FLIGHT-FLDATE < SY-DATUM.
      GS_FLIGHT-CH_PO = ICON_SPACE.
    ELSE.
      GS_FLIGHT-CH_PO = ICON_OKAY.
    ENDIF.

    MODIFY GT_FLIGHT FROM GS_FLIGHT
    TRANSPORTING COLOR LIGHT IT_COL CH_PO.
  ENDLOOP.
ENDFORM.


*&---------------------------------------------------------------------*
*& Include          ZBC405_B13_25_C01
*&---------------------------------------------------------------------*
CLASS LCL_EVENT_HANDLER DEFINITION.
*  ####### ### ### ##
  PUBLIC SECTION.
    CLASS-DATA: GV_ROWID TYPE I.
*  static - method# ##
    CLASS-METHODS:
      ON_DOUBLE_CLICK FOR EVENT DOUBLE_CLICK OF CL_GUI_ALV_GRID
*      ON_DOUBLE_CLICK FOR EVENT DOUBLE_CLICK OF if_salv_events_actions_table
*        IMPORTING row column.
        IMPORTING ES_ROW_NO E_COLUMN,
      "## #####
      ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
        IMPORTING E_OBJECT,

      ON_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
        IMPORTING E_UCOMM,

      ON_CONTEXT_MENU_REQ FOR EVENT CONTEXT_MENU_REQUEST OF CL_GUI_ALV_GRID IMPORTING E_OBJECT.
ENDCLASS.

CLASS LCL_EVENT_HANDLER IMPLEMENTATION.
  METHOD ON_DOUBLE_CLICK.
    DATA: LV_BOOKINGS_TOTAL   TYPE I,
          LV_BOOKINGS_TOTAL_C TYPE C LENGTH 10,
          LV_MESSAGE_TEXT     TYPE C LENGTH 60.

    READ TABLE GT_FLIGHT INTO GS_FLIGHT INDEX ES_ROW_NO-ROW_ID.

    IF SY-SUBRC NE 0.
      MESSAGE I075(BC405_408).
    ENDIF.

    LV_BOOKINGS_TOTAL = GS_FLIGHT-SEATSOCC + GS_FLIGHT-SEATSOCC_B + GS_FLIGHT-SEATSOCC_F.

    LV_BOOKINGS_TOTAL_C = LV_BOOKINGS_TOTAL.
    LV_MESSAGE_TEXT = 'Total Number Of Booking : '(M01) && LV_BOOKINGS_TOTAL_C && ' - ' && E_COLUMN-FIELDNAME.
*    LV_MESSAGE_TEXT = 'Total Number Of Booking : '(M01) && LV_BOOKINGS_TOTAL_C.
    MESSAGE LV_MESSAGE_TEXT TYPE 'I' .
  ENDMETHOD.

  METHOD ON_TOOLBAR.
*    Toolbar Button = STB_BUTTON
    DATA: LS_BUTTON TYPE STB_BUTTON.

    LS_BUTTON-BUTN_TYPE = 3.
*       1## ### #### ###
    INSERT LS_BUTTON INTO TABLE E_OBJECT->MT_TOOLBAR.

    CLEAR: LS_BUTTON.
    LS_BUTTON-FUNCTION = 'PERCENTAGE'.
    LS_BUTTON-TEXT = '% (total)'(tot).
    LS_BUTTON-QUICKINFO = 'Occupation (total)'(z01).
    LS_BUTTON-BUTN_TYPE = 0.
    INSERT LS_BUTTON INTO TABLE E_OBJECT->MT_TOOLBAR.

    CLEAR: LS_BUTTON.
    LS_BUTTON-FUNCTION = 'PERCENTAGE_MARKED'.
    LS_BUTTON-TEXT = '% (marked)'(mar).
    LS_BUTTON-QUICKINFO = 'Occupation (marked flights)'(z02).
    LS_BUTTON-BUTN_TYPE = 0.
    INSERT LS_BUTTON INTO TABLE E_OBJECT->MT_TOOLBAR.

  ENDMETHOD.

  METHOD on_user_command.
    DATA: lv_occupied TYPE i,
          lv_capacity TYPE i,
          lv_percentage TYPE p LENGTH 8 DECIMALS 1,
          lv_text type string,

          lt_row_no TYPE lvc_t_roid,
          ls_row_no TYPE lvc_s_roid.

    CASE e_ucomm.
      WHEN 'PERCENTAGE'.
        LOOP AT gt_flight into gs_flight.
          lv_occupied = lv_occupied + gs_flight-seatsocc.
          lv_capacity = lv_capacity + gs_flight-seatsmax.

        endloop.

        lv_percentage = lv_occupied * 100 / lv_capacity.
        MOVE lv_percentage to lv_text.
        lv_text = 'Percentage of occupied seats: ' && '  ' && lv_text.

        MESSAGE lv_text TYPE 'I'.


      WHEN 'PERCENTAGE_MARKED'.
        go_alv->get_selected_rows(
         IMPORTING

           et_row_no     =    lt_row_no              " Numeric IDs of Selected Rows
       ).

        IF lines( lt_row_no ) > 0 .
          LOOP AT lt_row_no INTO ls_row_no.
            READ TABLE gt_flight into gs_flight INDEX ls_row_no-row_id.

            lv_occupied = lv_occupied + gs_flight-seatsocc.
            lv_capacity = lv_capacity + gs_flight-seatsmax.

          ENDLOOP.

          lv_percentage = lv_occupied * 100 / lv_capacity.
          MOVE lv_percentage to lv_text.
          lv_text = 'Percentage of occupied seats: ' && '  ' && lv_text.

          MESSAGE lv_text TYPE 'I'.

        else.
          MESSAGE 'Please mark at least one row' TYPE 'I'.

        ENDIF.
    ENDCASE.
  ENDMETHOD.

  METHOD ON_CONTEXT_MENU_REQ.
    DATA: LS_COLUMN_INFO TYPE LVC_S_COL.

    GO_ALV->GET_CURRENT_CELL(
      IMPORTING
        E_ROW     =  GV_ROWID                " Row on Grid
        ES_COL_ID =     LS_COLUMN_INFO             " Column ID
    ).
    CASE LS_COLUMN_INFO.
      WHEN 'CARRID'.
        E_OBJECT->ADD_FUNCTION(
          EXPORTING
            FCODE             =    'CARRIER_INFO'              " Function code
            TEXT              =               'Carrier Info'(mel)   " Function text
        ).
      WHEN OTHERS.
    ENDCASE.
  ENDMETHOD.
ENDCLASS.
```

```ABAP
*&---------------------------------------------------------------------*
*&  Include BC405_INTRO_S1_TOP                                         *
*&---------------------------------------------------------------------*

DATA: GS_FLIGHT TYPE DV_FLIGHTS.

CONSTANTS GC_MARK VALUE 'X'.

SELECT-OPTIONS: SO_CAR FOR GS_FLIGHT-CARRID MEMORY ID CAR,
                SO_CON FOR GS_FLIGHT-CONNID,
                SO_FDT FOR GS_FLIGHT-FLDATE NO-EXTENSION.

SELECTION-SCREEN BEGIN OF BLOCK RADIO WITH FRAME.
  PARAMETERS: PA_ALL RADIOBUTTON GROUP RBG1,
              PA_NAT RADIOBUTTON GROUP RBG1,
              PA_INT RADIOBUTTON GROUP RBG1 DEFAULT 'X'.
SELECTION-SCREEN END OF BLOCK RADIO.

*&---------------------------------------------------------------------*
*&  Include BC405_INTRO_S_E01                                          *
*&---------------------------------------------------------------------*

INITIALIZATION.
  MOVE: 'AA' TO SO_CAR-LOW,
         'QF' TO SO_CAR-HIGH,
         'BT' TO SO_CAR-OPTION,
         'I' TO SO_CAR-SIGN.
  APPEND SO_CAR.

  CLEAR SO_CAR.
  MOVE: 'AZ' TO SO_CAR-LOW,
       'EQ' TO SO_CAR-HIGH,
       'E' TO SO_CAR-OPTION.
  APPEND SO_CAR.


START-OF-SELECTION.

  CASE GC_MARK.
    WHEN PA_ALL.
      SELECT * FROM  DV_FLIGHTS INTO GS_FLIGHT
        WHERE CARRID IN SO_CAR
        AND CONNID IN SO_CON
        AND FLDATE IN SO_FDT.
        WRITE: / GS_FLIGHT-CARRID,
                 GS_FLIGHT-CONNID,
                 GS_FLIGHT-FLDATE,
                 GS_FLIGHT-COUNTRYFR,
                 GS_FLIGHT-CITYFROM,
                 GS_FLIGHT-AIRPFROM,
                 GS_FLIGHT-COUNTRYTO,
                 GS_FLIGHT-CITYTO,
                 GS_FLIGHT-AIRPTO,
                 GS_FLIGHT-SEATSMAX,
                 GS_FLIGHT-SEATSOCC.
      ENDSELECT.
    WHEN PA_nat.
      SELECT * FROM  DV_FLIGHTS INTO GS_FLIGHT
        WHERE CARRID IN SO_CAR
        AND CONNID IN SO_CON
        AND FLDATE IN SO_FDT
        AND COUNTRYTO = DV_FLIGHTS~COUNTRYfr.
        WRITE: / GS_FLIGHT-CARRID,
                 GS_FLIGHT-CONNID,
                 GS_FLIGHT-FLDATE,
                 GS_FLIGHT-COUNTRYFR,
                 GS_FLIGHT-CITYFROM,
                 GS_FLIGHT-AIRPFROM,
                 GS_FLIGHT-COUNTRYTO,
                 GS_FLIGHT-CITYTO,
                 GS_FLIGHT-AIRPTO,
                 GS_FLIGHT-SEATSMAX,
                 GS_FLIGHT-SEATSOCC.
      ENDSELECT.
    WHEN PA_int.
      SELECT * FROM  DV_FLIGHTS INTO GS_FLIGHT
        WHERE CARRID IN SO_CAR
        AND CONNID IN SO_CON
        AND FLDATE IN SO_FDT
        AND COUNTRYTO <> DV_FLIGHTS~COUNTRYfr.
        WRITE: / GS_FLIGHT-CARRID,
                 GS_FLIGHT-CONNID,
                 GS_FLIGHT-FLDATE,
                 GS_FLIGHT-COUNTRYFR,
                 GS_FLIGHT-CITYFROM,
                 GS_FLIGHT-AIRPFROM,
                 GS_FLIGHT-COUNTRYTO,
                 GS_FLIGHT-CITYTO,
                 GS_FLIGHT-AIRPTO,
                 GS_FLIGHT-SEATSMAX,
                 GS_FLIGHT-SEATSOCC.
      ENDSELECT.

  ENDCASE.
  
  
```

```ABAP
Code listing for: ZBC400_13_STRUCTURE
Description: Report ZBC400_13_STRUCTURE
*&---------------------------------------------------------------------*
*& Report ZBC400_13_STRUCTURE
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZBC400_13_STRUCTURE.

DATA: GS_FILGHT  TYPE BC400_S_FLIGHT,
      GS_CARRIER TYPE BC400_S_CARRIER.

PARAMETERS: PA_CAR  TYPE BC400_S_FLIGHT-CARRID,
            PA_CON  TYPE BC400_S_FLIGHT-CONNID,
            PA_DATE TYPE BC400_S_FLIGHT-FLDATE.

TYPES: BEGIN OF TS_CARRIERFLIGHT,
         CARRID     TYPE BC400_S_FLIGHT-CARRID,
         CONNID     TYPE BC400_S_FLIGHT-CONNID,
         FLDATE     TYPE BC400_S_FLIGHT-FLDATE,
         SEATSMAX   TYPE BC400_S_FLIGHT-SEATSMAX,
         SEATSOCC   TYPE BC400_S_FLIGHT-SEATSOCC,
         PERCENTAGE TYPE BC400_S_FLIGHT-PERCENTAGE,
         CARRNAME   TYPE BC400_S_CARRIER-CARRNAME,
         CURRCODE   TYPE BC400_S_CARRIER-CURRCODE,
         URL        TYPE BC400_S_CARRIER-URL,
       END OF TS_CARRIERFLIGHT.

DATA: gs_CARRIERFLIGHT TYPE TS_CARRIERFLIGHT.

TRY.
    CALL METHOD CL_BC400_FLIGHTMODEL=>GET_FLIGHT
      EXPORTING
        IV_CARRID = PA_CAR
        IV_CONNID = PA_CON
        IV_FLDATE = PA_DATE
      IMPORTING
        ES_FLIGHT = GS_FILGHT.

    CALL METHOD CL_BC400_FLIGHTMODEL=>GET_CARRIER
      EXPORTING
        IV_CARRID  = PA_CAR
      IMPORTING
        ES_CARRIER = GS_CARRIER.

  CATCH CX_BC400_NO_DATA.
    WRITE:/ 'NO DATA FOUND!'.
  CATCH CX_BC400_NO_AUTH.
    WRITE:/ 'NO authority for this carrier!'.

ENDTRY.

MOVE-CORRESPONDING GS_CARRIER TO gs_CARRIERFLIGHT.
MOVE-CORRESPONDING GS_FILGHT TO gs_CARRIERFLIGHT.

IF gs_CARRIERFLIGHT IS NOT INITIAL.
  WRITE: / gs_CARRIERFLIGHT-CARRID,
  gs_CARRIERFLIGHT-FLDATE,
  gs_CARRIERFLIGHT-SEATSMAX,
  gs_CARRIERFLIGHT-SEATSOCC,
  gs_CARRIERFLIGHT-PERCENTAGE,
  gs_CARRIERFLIGHT-CARRNAME,
  gs_CARRIERFLIGHT-CURRCODE,
  gs_CARRIERFLIGHT-URL .

ENDIF.
```

```ABAP
Code listing for: ZBC401_B13_MAIN
Description: Program ZBC401_B13_MAIN
*&---------------------------------------------------------------------*
*& Report ZBC401_B13_MAIN
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZBC401_B13_MAIN.

TYPE-POOLS ICON.

CLASS LCL_AIRPLANE DEFINITION.
  PUBLIC SECTION.

*  Instance Method
    METHODS:
*      SET_ATTRIBUTES IMPORTING IV_NAME      TYPE STRING
*                               IV_PLANETYPE TYPE SAPLANE-PLANETYPE,
      CONSTRUCTOR IMPORTING  IV_NAME      TYPE STRING
                             IV_PLANETYPE TYPE SAPLANE-PLANETYPE
                  EXCEPTIONS WRONG_PLANETYPE,
      DISPLAY_ATTRIBUTES.

*   Static Method
    CLASS-METHODS:
      DISPLAY_N_O_AIRPLANES,
      GET_N_O_AIRPLANES RETURNING VALUE(RV_COUNT) TYPE I,
      CLASS_CONSTRUCTOR.

  PROTECTED SECTION.
    CONSTANTS: C_POS_1 TYPE I VALUE 30.

  PRIVATE SECTION.
    TYPES: TY_PLANETYPES TYPE STANDARD TABLE OF SAPLANE WITH NON-UNIQUE KEY PLANETYPE.
*  Instance Attribute.
    DATA: MV_NAME      TYPE STRING,
          MV_PLANETYPE TYPE SAPLANE-PLANETYPE,
          MV_WEIGHT    TYPE SAPLANE-WEIGHT,
          MV_TANKCAP   TYPE SAPLANE-TANKCAP.
*    Static data ##
    CLASS-DATA: GV_N_O_AIRPLANES TYPE I,
*                GT_PLANETYPES TYPE TY_PLANETYPES.
                GT_PLANETYPES    TYPE TABLE OF SAPLANE.
    CLASS-METHODS: GET_TECHNICAL_ATTR
      IMPORTING
        IV_TYPE    TYPE  SAPLANE-PLANETYPE
      EXPORTING
        EV_WEIGHT  TYPE SAPLANE-WEIGHT
        EV_TANKCAP TYPE SAPLANE-TANKCAP
      EXCEPTIONS
        WRONG_PLANETYPE.
ENDCLASS.

CLASS LCL_AIRPLANE IMPLEMENTATION.
*  METHOD SET_ATTRIBUTES.
*    MV_NAME = IV_NAME.
*    MV_PLANETYPE = IV_PLANETYPE.
*    GV_N_O_AIRPLANES = GV_N_O_AIRPLANES + 1.
*  ENDMETHOD.

  METHOD CLASS_CONSTRUCTOR.
    SELECT *
      INTO TABLE GT_PLANETYPES
      FROM SAPLANE.
  ENDMETHOD.

  METHOD GET_TECHNICAL_ATTR.
    DATA: LS_PLANETYPE TYPE SAPLANE.

    READ TABLE GT_PLANETYPES
          INTO LS_PLANETYPE
          WITH KEY PLANETYPE = IV_TYPE
*          WITH TABLE KEY PLANETYPE = IV_TYPE
          TRANSPORTING WEIGHT TANKCAP.

    IF SY-SUBRC = 0.
      EV_WEIGHT = LS_PLANETYPE-WEIGHT.
      EV_TANKCAP = LS_PLANETYPE-TANKCAP.
    ELSE.
      RAISE WRONG_PLANETYPE.
    ENDIF.
  ENDMETHOD.

  METHOD CONSTRUCTOR.
*    TABLE  # #### #### ##
    DATA: IS_PLANETYPE TYPE SAPLANE.
* MV_NAME # PRIVATE ### ## ### ### ###### ## ### ## ##
    MV_NAME = IV_NAME.
    MV_PLANETYPE = IV_PLANETYPE.

*    SELECT SINGLE *
*      FROM SAPLANE
*      INTO IS_PLANETYPE
*      WHERE PLANETYPE = IV_PLANETYPE.
    GET_TECHNICAL_ATTR(
      EXPORTING
        IV_TYPE         = IV_PLANETYPE
  IMPORTING
        EV_WEIGHT       = MV_WEIGHT
        EV_TANKCAP      = MV_TANKCAP
      EXCEPTIONS
        WRONG_PLANETYPE = 1
        OTHERS          = 2
    ).

    IF SY-SUBRC <> 0.
      RAISE WRONG_PLANETYPE.
    ELSE.
*      MV_WEIGHT = IS_PLANETYPE-WEIGHT.
*      MV_TANKCAP = IS_PLANETYPE-TANKCAP.
      GV_N_O_AIRPLANES = GV_N_O_AIRPLANES + 1.
    ENDIF.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    WRITE:/ ICON_WS_PLANE AS ICON,
    / 'Name of AIRPLANE : '(001), AT C_POS_1 MV_NAME,
    / 'Type of AIRPLANE : '(002), AT C_POS_1 MV_PLANETYPE,
    / 'Weight : '(003), AT C_POS_1 MV_WEIGHT
    LEFT-JUSTIFIED,
    / 'Tank capacity : '(004), AT C_POS_1 MV_TANKCAP
    LEFT-JUSTIFIED.
  ENDMETHOD.

  METHOD DISPLAY_N_O_AIRPLANES.
    SKIP.
    WRITE:/ 'Number of AIRPLANE: '(cal),
    AT C_POS_1 GV_N_O_AIRPLANES LEFT-JUSTIFIED.
  ENDMETHOD.

  METHOD GET_N_O_AIRPLANES.
    RV_COUNT = GV_N_O_AIRPLANES.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_CARGO_PLANE DEFINITION INHERITING FROM LCL_AIRPLANE.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING  IV_NAME_C      TYPE STRING
                             IV_PLANETYPE_C TYPE SAPLANE-PLANETYPE
                             IV_CARGO       TYPE S_PLAN_CAR
                  EXCEPTIONS WRONG_PLANETYPE,
      DISPLAY_ATTRIBUTES REDEFINITION.
  PRIVATE SECTION.
    DATA: MV_CARGO TYPE S_PLAN_CAR.
ENDCLASS.

CLASS LCL_CARGO_PLANE IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    SUPER->CONSTRUCTOR(
      EXPORTING
        IV_NAME         = IV_NAME_C
        IV_PLANETYPE    = IV_PLANETYPE_C
      EXCEPTIONS
        WRONG_PLANETYPE = 1
        OTHERS          = 2
    ).
    IF SY-SUBRC <> 0.
      RAISE WRONG_PLANETYPE.
    ENDIF.
    MV_CARGO = IV_CARGO.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    SUPER->DISPLAY_ATTRIBUTES( ).
    WRITE:/'Max Cargo : '(007), AT C_POS_1 MV_CARGO
    LEFT-JUSTIFIED.
    ULINE.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_PASSENGER_PLANE DEFINITION INHERITING FROM LCL_AIRPLANE.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING  IV_NAME_P      TYPE STRING
                             IV_PLANETYPE_P TYPE SAPLANE-PLANETYPE
                             IV_SEATS       TYPE S_SEATSMAX
                  EXCEPTIONS WRONG_PLANETYPE,
      DISPLAY_ATTRIBUTES REDEFINITION.
  PRIVATE SECTION.
    DATA: MV_SEATS TYPE S_SEATSMAX.
ENDCLASS.

CLASS LCL_PASSENGER_PLANE IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    SUPER->CONSTRUCTOR(
      EXPORTING
        IV_NAME         = IV_NAME_P
        IV_PLANETYPE    = IV_PLANETYPE_P
      EXCEPTIONS
        WRONG_PLANETYPE = 1
        OTHERS          = 2
    ).
    IF SY-SUBRC <> 0.
      RAISE WRONG_PLANETYPE.
    ENDIF.
    MV_SEATS = IV_SEATS.
  ENDMETHOD.
  METHOD DISPLAY_ATTRIBUTES.
    SUPER->DISPLAY_ATTRIBUTES( ).
    WRITE:/'Max Seats : '(006), AT C_POS_1 MV_SEATS
    LEFT-JUSTIFIED.
    ULINE.
  ENDMETHOD.
ENDCLASS.


DATA: GO_AIRPLANE  TYPE REF TO LCL_AIRPLANE,
      GO_CARGO     TYPE REF TO LCL_CARGO_PLANE,
      GO_PASSENGER TYPE REF TO LCL_PASSENGER_PLANE,
      GT_AIRPLANES TYPE TABLE OF REF TO LCL_AIRPLANE,
      GV_COUNT     TYPE I.

START-OF-SELECTION.
  LCL_AIRPLANE=>DISPLAY_N_O_AIRPLANES( ).

  CREATE OBJECT GO_CARGO
    EXPORTING
      IV_NAME_C       = 'US Hercules'
      IV_PLANETYPE_C  = '747-200F'
      IV_CARGO        = 533
    EXCEPTIONS
      WRONG_PLANETYPE = 1
      OTHERS          = 2.

  CREATE OBJECT GO_PASSENGER
    EXPORTING
      IV_NAME_P       = 'LH Berlin'
      IV_PLANETYPE_P  = '747-400'
      IV_SEATS        = 345
    EXCEPTIONS
      WRONG_PLANETYPE = 1
      OTHERS          = 2
    .
  CREATE OBJECT GO_AIRPLANE
    EXPORTING
      IV_NAME         = 'LH Berlin'
      IV_PLANETYPE    = 'A321'
    EXCEPTIONS
      WRONG_PLANETYPE = 1.
  IF SY-SUBRC = 0.
    APPEND GO_AIRPLANE TO GT_AIRPLANES.
  ENDIF.

  CREATE OBJECT GO_AIRPLANE
    EXPORTING
      IV_NAME         = 'AA New York'
      IV_PLANETYPE    = '747-400'
    EXCEPTIONS
      WRONG_PLANETYPE = 1.
  IF SY-SUBRC = 0.
    APPEND GO_AIRPLANE TO GT_AIRPLANES.
  ENDIF.

  CREATE OBJECT GO_AIRPLANE
    EXPORTING
      IV_NAME         = 'US Hercules'
      IV_PLANETYPE    = '747-200F'
    EXCEPTIONS
      WRONG_PLANETYPE = 1.
  IF SY-SUBRC = 0.
    APPEND GO_AIRPLANE TO GT_AIRPLANES.
  ENDIF.

  LOOP AT GT_AIRPLANES INTO GO_AIRPLANE.
    GO_AIRPLANE->DISPLAY_ATTRIBUTES( ).
  ENDLOOP.

  GV_COUNT = LCL_AIRPLANE=>GET_N_O_AIRPLANES( ).
  GO_CARGO->DISPLAY_ATTRIBUTES( ).
  GO_PASSENGER->DISPLAY_ATTRIBUTES( ).

  SKIP 2.
  WRITE:/ 'Number of AIRPLANE'(cal), GV_COUNT.
```

```ABAP
SELECT ID, NAME, CUSTTYPE,
  CASE WHEN CUSTTYPE = 'P' THEN  'Private Customer'
       WHEN CUSTTYPE = 'B' THEN  'Business Customer'
        ELSE ' '
  END AS CUSTTYPE_TXT
FROM SCUSTOM
INTO TABLE @DATA(GT_DATA) UP TO 30 ROWS.

CL_DEMO_OUTPUT=>DISPLAY( GT_DATA ).

```

```ABAP
PARAMETERS: PA_CAR TYPE SBOOK-CARRID,
            PA_SMK TYPE P LENGTH 3 DECIMALS 2.

CONSTANTS: GC_NON TYPE P LENGTH 3 DECIMALS 2 VALUE '0.90'.

* ### ##### ##.
SELECT  FROM ZCDS_INPUT_PARAM_B13(
  SMK = @PA_SMK,
  CAR = @PA_CAR,
  CUR = 'USD',
  NON = @GC_NON )
  FIELDS * INTO TABLE @DATA(GT_DATA)
  UP TO 50 ROWS.

CL_DEMO_OUTPUT=>DISPLAY( GT_DATA ).
```

```ABAP
DATA: GS_FLIGHT TYPE ZTSFLIGHT_B13,
      GT_FLIGHT LIKE TABLE OF GS_FLIGHT.

SELECT SINGLE *
  INTO CORRESPONDING FIELDS OF GS_FLIGHT
  FROM ZTSFLIGHT_B13
  WHERE CARRID = 'AA'
    AND CONNID = '0017'
    AND FLDATE = SY-DATUM.

IF SY-SUBRC = 0.
  GS_FLIGHT-PRICE = '422.94'.
  GS_FLIGHT-CURRENCY = 'USD'.
  GS_FLIGHT-PLANETYPE = '747-400'.
  GS_FLIGHT-PAYMENTSUM = '192860.89'.

*  UPDATE ZTSFLIGHT_B13 FROM GS_FLIGHT.
  UPDATE ZTSFLIGHT_B13 SET SEATSMAX_B = 123
                           SEATSOCC_B = 456
                           SEATSMAX_F = 1
                           SEATSOCC_F = 7
  WHERE CARRID = 'AA'
    AND CONNID = '0017'
    AND FLDATE = '20240820'.

  IF SY-SUBRC = 0.
    MESSAGE 'Success, data save' TYPE 'I'.
  ELSE.
    MESSAGE 'Error, data save' TYPE 'I'.
  ENDIF.
ENDIF.



DATA: GS_FLIGHT TYPE ZTSFLIGHT_B13,
      GT_FLIGHT LIKE TABLE OF GS_FLIGHT.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_FLIGHT
  FROM ZTSFLIGHT_B13
  WHERE CARRID = 'AA'.

LOOP AT GT_FLIGHT INTO GS_FLIGHT.
  GS_FLIGHT-PRICE = 600.
  GS_FLIGHT-CURRENCY = 'EUR'.

  MODIFY GT_FLIGHT FROM GS_FLIGHT.
  CLEAR: GS_FLIGHT.
ENDLOOP.

UPDATE ZTSFLIGHT_B13 FROM TABLE GT_FLIGHT.
UPDATE ZTSFLIGHT_B13
  SET PRICE = '10.00' CURRENCY = 'USD'
  WHERE CARRID = 'LH'
    AND CONNID = '0400'.

IF SY-SUBRC = 0.
  MESSAGE 'Success, data save' TYPE 'I'.
ELSE.
  MESSAGE 'Error, data save' TYPE 'I'.
ENDIF.


DATA: GS_FLIGHT TYPE ZTSFLIGHT_B13,
      GT_FLIGHT LIKE TABLE OF GS_FLIGHT.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_FLIGHT
  FROM ZTSFLIGHT_B13
  WHERE CARRID = 'LH'
    AND CONNID = '0400'.

LOOP AT GT_FLIGHT INTO GS_FLIGHT.
  GS_FLIGHT-PRICE = '777.7'.
  GS_FLIGHT-CURRENCY = 'EUR'.

  MODIFY GT_FLIGHT FROM GS_FLIGHT.
  CLEAR: GS_FLIGHT.
ENDLOOP.

* APPENDING# ### ### ####? ADD ## ### ### ###.
SELECT *
  APPENDING CORRESPONDING FIELDS OF TABLE GT_FLIGHT
  FROM SFLIGHT
  WHERE CARRID = 'QF'
    AND CONNID = '0005'.

* #### #### UPDATE
* #### ### INSERT
MODIFY ZTSFLIGHT_B13 FROM TABLE GT_FLIGHT.

IF SY-SUBRC = 0.
  MESSAGE 'Success, data save' TYPE 'I'.
ELSE.
  MESSAGE 'Error, data save' TYPE 'I'.
ENDIF.


DATA: GS_FLIGHT TYPE ZTSFLIGHT_B13,
      GT_FLIGHT LIKE TABLE OF GS_FLIGHT.

GS_FLIGHT-CARRID = 'AA'.
GS_FLIGHT-CONNID = '0017'.
GS_FLIGHT-FLDATE = SY-DATUM.

*DELETE ZTSFLIGHT_B13 FROM GS_FLIGHT.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_FLIGHT
  FROM ZTSFLIGHT_B13
  WHERE CARRID = 'LH'
  AND CONNID = '0402'.

*DELETE ZTSFLIGHT_B13 FROM TABLE GT_FLIGHT.
DELETE FROM ZTSFLIGHT_B13 WHERE CURRENCY = 'AUD'.


IF SY-SUBRC = 0.
  MESSAGE 'Success, data save' TYPE 'I'.
ELSE.
  MESSAGE 'Error, data save' TYPE 'I'.
ENDIF.


Code listing for: ZABAP_B13_42
Description: Local Class
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_42
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_42.

* local class ##.
* public -> protected -> private ##! #!
CLASS LCL_VEHICLE DEFINITION.
  PUBLIC SECTION.
*  Instance Method
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE  TYPE STRING
                             IV_MODEL TYPE STRING
                  EXCEPTIONS WRONG_VEHICLE,

      SET_ATTRIBUTES IMPORTING IV_MAKE  TYPE STRING
                               IV_MODEL TYPE STRING,
      DISPLAY_ATTRIBUTES.

*   Static Method
    CLASS-METHODS:
      DISPLAY_N_O_VEHICLE,
      GET_N_O_VEHICLE RETURNING VALUE(RV_CNT) TYPE I,
      CLASS_CONSTRUCTOR.

    DATA: MV_COLOR TYPE STRING VALUE 'Black'.
    CLASS-DATA : MV_PRICE TYPE STRING VALUE '2000##'.

  PRIVATE SECTION.
*  Instance Attribute.
    DATA: MV_MAKE  TYPE STRING,
          MV_MODEL TYPE STRING.
*    Static data ##
    CLASS-DATA: GV_N_O_VEHICLE TYPE I,
                GT_VEHICLE     TYPE TABLE OF SVEHICLE.

ENDCLASS.

CLASS LCL_VEHICLE IMPLEMENTATION.

  METHOD CLASS_CONSTRUCTOR.
    SELECT *
      INTO TABLE GT_VEHICLE
      FROM SVEHICLE.
  ENDMETHOD.

  METHOD CONSTRUCTOR.
*    DB# ### ## ### ## ## #### ## ### #### ##
*    SELECT COUNT( * )
*      FROM SVEHICLE
*      WHERE MAKE = IV_MAKE
*        AND MODEL = IV_MODEL.

    READ TABLE GT_VEHICLE
    WITH KEY MAKE = IV_MAKE
             MODEL = IV_MODEL
    TRANSPORTING NO FIELDS.

    IF SY-SUBRC = 0.
      MV_MAKE = IV_MAKE.
      MV_MODEL = IV_MODEL.
    ELSE.
      RAISE WRONG_VEHICLE.
    ENDIF.
  ENDMETHOD.

  METHOD SET_ATTRIBUTES.
    MV_MAKE = IV_MAKE.
    MV_MODEL = IV_MODEL.

    ADD 1 TO GV_N_O_VEHICLE.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    WRITE:/ 'Make :', MV_MAKE.
    WRITE:/ 'Model : ', MV_MODEL.
  ENDMETHOD.

* Static method### static attr# ### ####.
  METHOD DISPLAY_N_O_VEHICLE.
    WRITE:/ 'Number of Vehicle : ', GV_N_O_VEHICLE.
*    #### #### attr# ## ### ####.
*    WRITE:/ 'Make : ', MV_MAKE.
  ENDMETHOD.

  METHOD GET_N_O_VEHICLE.
    RV_CNT = GV_N_O_VEHICLE.
  ENDMETHOD.
ENDCLASS.

* REF TO : LCL_VEHICLE# ####
*DATA: GO_VEHICLE1 TYPE REF TO LCL_VEHICLE,
*      GO_VEHICLE2 TYPE REF TO LCL_VEHICLE,
*      GO_VEHICLE3 LIKE GO_VEHICLE1.

DATA: GO_VEHICLE TYPE REF TO LCL_VEHICLE,
      GT_VEHICLE TYPE TABLE OF REF TO LCL_VEHICLE.

DATA: GV_CNT TYPE I.

START-OF-SELECTION.

  CALL METHOD LCL_VEHICLE=>DISPLAY_N_O_VEHICLE.

*  CREATE OBJECT GO_VEHICLE.

  CREATE OBJECT GO_VEHICLE
    EXPORTING
      IV_MAKE       = 'BMW'
      IV_MODEL      = '123'
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2.
*   0##  CREATE OBJECT# #####
  IF SY-SUBRC = 0.
*    ##### ITAB## ####
    APPEND GO_VEHICLE TO GT_VEHICLE.
  ENDIF.

  CREATE OBJECT GO_VEHICLE
    EXPORTING
      IV_MAKE       = 'AUDI'
      IV_MODEL      = 'A3'
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2.
  IF SY-SUBRC = 0.
    APPEND GO_VEHICLE TO GT_VEHICLE.
  ENDIF.

  CREATE OBJECT GO_VEHICLE
    EXPORTING
      IV_MAKE       = 'PORSCHE'
      IV_MODEL      = '911'
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2.
  IF SY-SUBRC = 0.
    APPEND GO_VEHICLE TO GT_VEHICLE.
  ENDIF.
*
* ### ## ## ###
*  CALL METHOD GO_VEHICLE->SET_ATTRIBUTES
*    EXPORTING
*      IV_MAKE  = 'BMW'
*      IV_MODEL = '325I'.
*
*  APPEND GO_VEHICLE TO GT_VEHICLE.
*
*  CREATE OBJECT GO_VEHICLE.
*  APPEND GO_VEHICLE TO GT_VEHICLE.
*
*  GO_VEHICLE->SET_ATTRIBUTES(
*    EXPORTING
*      IV_MAKE  = 'AUDI'
*      IV_MODEL = 'A3'
*  ).
*
*  CREATE OBJECT GO_VEHICLE.
*  APPEND GO_VEHICLE TO GT_VEHICLE.
*
*  GO_VEHICLE->SET_ATTRIBUTES(
*    EXPORTING
*      IV_MAKE  = 'PORSCHE'
*      IV_MODEL = '911'
*  ).

  LOOP AT GT_VEHICLE INTO GO_VEHICLE.
    CALL METHOD GO_VEHICLE->DISPLAY_ATTRIBUTES.
    ULINE.
  ENDLOOP.

*  CALL METHOD LCL_VEHICLE=>GET_N_O_VEHICLE
*    RECEIVING
*      RV_CNT = GV_CNT.
  GV_CNT = LCL_VEHICLE=>GET_N_O_VEHICLE( ).

  WRITE:/ 'Number of Vehicle : ', GV_CNT.

  DO LCL_VEHICLE=>GET_N_O_VEHICLE( ) TIMES.
    WRITE:/ SY-INDEX.
  ENDDO.

  IF LCL_VEHICLE=>GET_N_O_VEHICLE( ) = 3.
    WRITE:/ 'test'.
  ENDIF.

  GV_CNT = LCL_VEHICLE=>GET_N_O_VEHICLE( ) + LCL_VEHICLE=>GET_N_O_VEHICLE( ).
  WRITE:/  GV_CNT.

*  LCL_VEHICLE=>DISPLAY_N_O_VEHICLE( ).

*  APPEND GO_VEHICLE TO GT_VEHICLE.
*
*  CREATE OBJECT GO_VEHICLE.
*  APPEND GO_VEHICLE TO GT_VEHICLE.
*
*  CREATE OBJECT GO_VEHICLE.
*  APPEND GO_VEHICLE TO GT_VEHICLE.


*  CREATE OBJECT GO_VEHICLE1.
*
** GO_VEHICLE1# ### ## ##.
*  IF GO_VEHICLE1 IS NOT BOUND.
*
*  ENDIF.
*
**  # ### #### ##.
*  IF GO_VEHICLE1 IS INITIAL.
*
*  ENDIF.
*
**  # ### #### ##.
*  IF GO_VEHICLE1 IS BOUND.
*
*  ENDIF.
*
*  CREATE OBJECT GO_VEHICLE2.
*  CREATE OBJECT GO_VEHICLE3.

  IF SY-SUBRC = 0.

  ENDIF.

  WRITE:/ 'Color : ', GO_VEHICLE->MV_COLOR,
        /'Price : ', GO_VEHICLE->MV_PRICE.

```

```ABAP
DATA: GT_DATA TYPE TABLE OF ZSSEATS_B13.

SELECT CARRID, CONNID, FLDATE, SEATSMAX, SEATSOCC,
  SEATSMAX - SEATSOCC AS SEATSFREE,
  DIVISION( SEATSOCC * 100, SEATSMAX, 2 ) AS BOOKRATE
FROM SFLIGHT
  INTO CORRESPONDING FIELDS OF TABLE @GT_DATA.

CL_DEMO_OUTPUT=>DISPLAY( GT_DATA ).

Code listing for: ZABAP_B13_422
Description: Local Class
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_42
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_422.

* local class ##.
* public -> protected -> private ##! #!
CLASS LCL_VEHICLE DEFINITION.
  PUBLIC SECTION.
*  Instance Method
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE  TYPE STRING
                             IV_MODEL TYPE STRING
                  EXCEPTIONS WRONG_VEHICLE,

      SET_ATTRIBUTES IMPORTING IV_MAKE  TYPE STRING
                               IV_MODEL TYPE STRING,
      DISPLAY_ATTRIBUTES.

*   Static Method
    CLASS-METHODS:
      DISPLAY_N_O_VEHICLE,
      GET_N_O_VEHICLE RETURNING VALUE(RV_CNT) TYPE I,
      CLASS_CONSTRUCTOR.

    DATA: MV_COLOR TYPE STRING VALUE 'Black'.
    CLASS-DATA : MV_PRICE TYPE STRING VALUE '2000##'.

  PRIVATE SECTION.
*  Instance Attribute.
    DATA: MV_MAKE  TYPE STRING,
          MV_MODEL TYPE STRING.
*    Static data ##
    CLASS-DATA: GV_N_O_VEHICLE TYPE I,
                GT_VEHICLE     TYPE TABLE OF SVEHICLE.

ENDCLASS.

CLASS LCL_VEHICLE IMPLEMENTATION.

  METHOD CLASS_CONSTRUCTOR.
    SELECT *
      INTO TABLE GT_VEHICLE
      FROM SVEHICLE.
  ENDMETHOD.

  METHOD CONSTRUCTOR.
*    DB# ### ## ### ## ## #### ## ### #### ##
*    SELECT COUNT( * )
*      FROM SVEHICLE
*      WHERE MAKE = IV_MAKE
*        AND MODEL = IV_MODEL.

    READ TABLE GT_VEHICLE
    WITH KEY MAKE = IV_MAKE
             MODEL = IV_MODEL
    TRANSPORTING NO FIELDS.

    IF SY-SUBRC = 0.
      MV_MAKE = IV_MAKE.
      MV_MODEL = IV_MODEL.
    ELSE.
      RAISE WRONG_VEHICLE.
    ENDIF.
  ENDMETHOD.

  METHOD SET_ATTRIBUTES.
    MV_MAKE = IV_MAKE.
    MV_MODEL = IV_MODEL.

    ADD 1 TO GV_N_O_VEHICLE.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    WRITE:/ 'Make :', MV_MAKE.
    WRITE:/ 'Model : ', MV_MODEL.
  ENDMETHOD.

* Static method### static attr# ### ####.
  METHOD DISPLAY_N_O_VEHICLE.
    WRITE:/ 'Number of Vehicle : ', GV_N_O_VEHICLE.
*    #### #### attr# ## ### ####.
*    WRITE:/ 'Make : ', MV_MAKE.
  ENDMETHOD.

  METHOD GET_N_O_VEHICLE.
    RV_CNT = GV_N_O_VEHICLE.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_BUS DEFINITION INHERITING FROM LCL_VEHICLE.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE_B  TYPE STRING
                             IV_MODEL_B TYPE STRING
                             IV_SEATS   TYPE I
                  EXCEPTIONS WRONG_VEHICLE,
      DISPLAY_ATTRIBUTES REDEFINITION.
  PROTECTED SECTION.
  PRIVATE SECTION.
    DATA: MV_SEATS TYPE I.
ENDCLASS.

CLASS LCL_BUS IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    SUPER->CONSTRUCTOR(
      EXPORTING
        IV_MAKE       = IV_MAKE_B
        IV_MODEL      = IV_MODEL_B
      EXCEPTIONS
        WRONG_VEHICLE = 1
        OTHERS        = 2
    ).
    IF SY-SUBRC <> 0.
      RAISE WRONG_VEHICLE.
    ENDIF.
    MV_SEATS = IV_SEATS.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    SUPER->DISPLAY_ATTRIBUTES( ).
    WRITE:/ 'Max Seats : ', MV_SEATS.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_TRUCK DEFINITION INHERITING FROM LCL_VEHICLE.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE_T  TYPE STRING
                             IV_MODEL_T TYPE STRING
                             IV_CARGO   TYPE I
                  EXCEPTIONS WRONG_VEHICLE,
      DISPLAY_ATTRIBUTES REDEFINITION.
  PRIVATE SECTION.
    DATA: MV_CARGO TYPE I.
ENDCLASS.

CLASS LCL_TRUCK IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    SUPER->CONSTRUCTOR(
      EXPORTING
        IV_MAKE       = IV_MAKE_T
        IV_MODEL      = IV_MODEL_T
      EXCEPTIONS
        WRONG_VEHICLE = 1
        OTHERS        = 2
    ).
    IF SY-SUBRC <> 0.
      RAISE WRONG_VEHICLE.
    ENDIF.
    MV_CARGO = IV_CARGO.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    SUPER->DISPLAY_ATTRIBUTES( ).
    WRITE:/ 'Max Cargo : ', MV_CARGO.
  ENDMETHOD.
ENDCLASS.

* REF TO : LCL_VEHICLE# ####
*DATA: GO_VEHICLE1 TYPE REF TO LCL_VEHICLE,
*      GO_VEHICLE2 TYPE REF TO LCL_VEHICLE,
*      GO_VEHICLE3 LIKE GO_VEHICLE1.

DATA: GO_VEHICLE TYPE REF TO LCL_VEHICLE,
      GT_VEHICLE TYPE TABLE OF REF TO LCL_VEHICLE,
      GO_BUS     TYPE REF TO LCL_BUS,
      GO_TRUCK   TYPE REF TO LCL_TRUCK.

DATA: GV_CNT TYPE I.

START-OF-SELECTION.

  CREATE OBJECT GO_BUS
    EXPORTING
      IV_MAKE_B     = 'MERCEDES'
      IV_MODEL_B    = 'SPRINTER'
      IV_SEATS      = 20
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2
    .
  IF SY-SUBRC <> 0.

  ENDIF.

  CREATE OBJECT GO_TRUCK
    EXPORTING
      IV_MAKE_T     = 'MAN'
      IV_MODEL_T    = 'TGX'
      IV_CARGO      = 350
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2
    .
  IF SY-SUBRC <> 0.
  ENDIF.

  GO_BUS->DISPLAY_ATTRIBUTES( ).
  ULINE.
  GO_TRUCK->DISPLAY_ATTRIBUTES( ).

```

```ABAP
Code listing for: ZABAP_B13_423
Description: Local Class
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_42
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_423.

* local class ##.
* public -> protected -> private ##! #!
CLASS LCL_VEHICLE DEFINITION.
  PUBLIC SECTION.
*  Instance Method
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE  TYPE STRING
                             IV_MODEL TYPE STRING
                  EXCEPTIONS WRONG_VEHICLE,

      SET_ATTRIBUTES IMPORTING IV_MAKE  TYPE STRING
                               IV_MODEL TYPE STRING,
      DISPLAY_ATTRIBUTES.

*   Static Method
    CLASS-METHODS:
      DISPLAY_N_O_VEHICLE,
      GET_N_O_VEHICLE RETURNING VALUE(RV_CNT) TYPE I,
      CLASS_CONSTRUCTOR.

    DATA: MV_COLOR TYPE STRING VALUE 'Black'.
    CLASS-DATA : MV_PRICE TYPE STRING VALUE '2000##'.

  PRIVATE SECTION.
*  Instance Attribute.
    DATA: MV_MAKE  TYPE STRING,
          MV_MODEL TYPE STRING.
*    Static data ##
    CLASS-DATA: GV_N_O_VEHICLE TYPE I,
                GT_VEHICLE     TYPE TABLE OF SVEHICLE.

ENDCLASS.

CLASS LCL_VEHICLE IMPLEMENTATION.

  METHOD CLASS_CONSTRUCTOR.
    SELECT *
      INTO TABLE GT_VEHICLE
      FROM SVEHICLE.
  ENDMETHOD.

  METHOD CONSTRUCTOR.
*    DB# ### ## ### ## ## #### ## ### #### ##
*    SELECT COUNT( * )
*      FROM SVEHICLE
*      WHERE MAKE = IV_MAKE
*        AND MODEL = IV_MODEL.

    READ TABLE GT_VEHICLE
    WITH KEY MAKE = IV_MAKE
             MODEL = IV_MODEL
    TRANSPORTING NO FIELDS.

    IF SY-SUBRC = 0.
      MV_MAKE = IV_MAKE.
      MV_MODEL = IV_MODEL.
    ELSE.
      RAISE WRONG_VEHICLE.
    ENDIF.
  ENDMETHOD.

  METHOD SET_ATTRIBUTES.
    MV_MAKE = IV_MAKE.
    MV_MODEL = IV_MODEL.

    ADD 1 TO GV_N_O_VEHICLE.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    WRITE:/ 'Make :', MV_MAKE.
    WRITE:/ 'Model : ', MV_MODEL.
  ENDMETHOD.

* Static method### static attr# ### ####.
  METHOD DISPLAY_N_O_VEHICLE.
    WRITE:/ 'Number of Vehicle : ', GV_N_O_VEHICLE.
*    #### #### attr# ## ### ####.
*    WRITE:/ 'Make : ', MV_MAKE.
  ENDMETHOD.

  METHOD GET_N_O_VEHICLE.
    RV_CNT = GV_N_O_VEHICLE.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_BUS DEFINITION INHERITING FROM LCL_VEHICLE.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE_B  TYPE STRING
                             IV_MODEL_B TYPE STRING
                             IV_SEATS   TYPE I
                  EXCEPTIONS WRONG_VEHICLE,
      DISPLAY_ATTRIBUTES REDEFINITION.
  PROTECTED SECTION.
  PRIVATE SECTION.
    DATA: MV_SEATS TYPE I.
ENDCLASS.

CLASS LCL_BUS IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    SUPER->CONSTRUCTOR(
      EXPORTING
        IV_MAKE       = IV_MAKE_B
        IV_MODEL      = IV_MODEL_B
      EXCEPTIONS
        WRONG_VEHICLE = 1
        OTHERS        = 2
    ).
    IF SY-SUBRC <> 0.
      RAISE WRONG_VEHICLE.
    ENDIF.
    MV_SEATS = IV_SEATS.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    SUPER->DISPLAY_ATTRIBUTES( ).
    WRITE:/ 'Max Seats : ', MV_SEATS.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_TRUCK DEFINITION INHERITING FROM LCL_VEHICLE.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING  IV_MAKE_T  TYPE STRING
                             IV_MODEL_T TYPE STRING
                             IV_CARGO   TYPE I
                  EXCEPTIONS WRONG_VEHICLE,
      DISPLAY_ATTRIBUTES REDEFINITION.
  PRIVATE SECTION.
    DATA: MV_CARGO TYPE I.
ENDCLASS.

CLASS LCL_TRUCK IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    SUPER->CONSTRUCTOR(
      EXPORTING
        IV_MAKE       = IV_MAKE_T
        IV_MODEL      = IV_MODEL_T
      EXCEPTIONS
        WRONG_VEHICLE = 1
        OTHERS        = 2
    ).
    IF SY-SUBRC <> 0.
      RAISE WRONG_VEHICLE.
    ENDIF.
    MV_CARGO = IV_CARGO.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    SUPER->DISPLAY_ATTRIBUTES( ).
    WRITE:/ 'Max Cargo : ', MV_CARGO.
  ENDMETHOD.
ENDCLASS.

CLASS LCL_RENTAL DEFINITION.
  PUBLIC SECTION.
    METHODS:
      CONSTRUCTOR IMPORTING IV_NAME TYPE STRING,
      DISPLAY_ATTRIBUTES,
      ADD_VEHICLE IMPORTING IO_VEHICLE TYPE REF TO LCL_VEHICLE.

  PRIVATE SECTION.
    DATA: MV_NAME    TYPE STRING,
          MT_VEHICLE TYPE TABLE OF REF TO LCL_VEHICLE.
ENDCLASS.

CLASS LCL_RENTAL IMPLEMENTATION.
  METHOD CONSTRUCTOR.
    MV_NAME = IV_NAME.
  ENDMETHOD.

  METHOD ADD_VEHICLE.
    APPEND IO_VEHICLE TO MT_VEHICLE.
  ENDMETHOD.

  METHOD DISPLAY_ATTRIBUTES.
    DATA LO_VEHICLE TYPE REF TO LCL_VEHICLE.
    WRITE:/ 'Name : ', MV_NAME.
    ULINE.

    LOOP AT MT_VEHICLE INTO LO_VEHICLE.
      LO_VEHICLE->DISPLAY_ATTRIBUTES( ).
      ULINE.
    ENDLOOP.
  ENDMETHOD.
ENDCLASS.

* REF TO : LCL_VEHICLE# ####
*DATA: GO_VEHICLE1 TYPE REF TO LCL_VEHICLE,
*      GO_VEHICLE2 TYPE REF TO LCL_VEHICLE,
*      GO_VEHICLE3 LIKE GO_VEHICLE1.

DATA: GO_VEHICLE TYPE REF TO LCL_VEHICLE,
      GT_VEHICLE TYPE TABLE OF REF TO LCL_VEHICLE,
      GO_BUS     TYPE REF TO LCL_BUS,
      GO_TRUCK   TYPE REF TO LCL_TRUCK,
      GO_RENTAL  TYPE REF TO LCL_RENTAL.

DATA: GV_CNT TYPE I.

START-OF-SELECTION.

  CREATE OBJECT GO_RENTAL
    EXPORTING
      IV_NAME = 'SYNC Rental Co.'.

  CREATE OBJECT GO_BUS
    EXPORTING
      IV_MAKE_B     = 'MERCEDES'
      IV_MODEL_B    = 'SPRINTER'
      IV_SEATS      = 20
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2.
  IF SY-SUBRC = 0.
*    UPCAST # ###.
*    APPEND GO_BUS TO GT_VEHICLE.
    GO_RENTAL->ADD_VEHICLE( IO_VEHICLE = GO_BUS ).
  ENDIF.

  CREATE OBJECT GO_TRUCK
    EXPORTING
      IV_MAKE_T     = 'MAN'
      IV_MODEL_T    = 'TGX'
      IV_CARGO      = 350
    EXCEPTIONS
      WRONG_VEHICLE = 1
      OTHERS        = 2.
  IF SY-SUBRC = 0.
*    UPCAST # ###.
*    APPEND GO_TRUCK TO GT_VEHICLE.
    GO_RENTAL->ADD_VEHICLE( IO_VEHICLE = GO_TRUCK ).
  ENDIF.

*  GO_BUS->DISPLAY_ATTRIBUTES( ).
*  ULINE.
*  GO_TRUCK->DISPLAY_ATTRIBUTES( ).

* DISPLAY_ATTRIBUTES( ) ## #### #,### ##### ## ##
*  LOOP AT GT_VEHICLE INTO GO_VEHICLE.
*    GO_VEHICLE->DISPLAY_ATTRIBUTES( ).
*    ULINE.
*  ENDLOOP.

  GO_RENTAL->DISPLAY_ATTRIBUTES( ).

```

```ABAP

TYPES: BEGIN OF TS_DATA,
         CONALL TYPE I,
         CONDIS TYPE I,
         SUMALL TYPE I,
         SUMDIS TYPE I,
       END OF TS_DATA.

DATA: GS_DATA TYPE TS_DATA.

SELECT COUNT( * ) COUNT( DISTINCT CARRID )
  SUM( SEATSOCC ) SUM( DISTINCT SEATSOCC )
  INTO GS_DATA
  FROM SFLIGHT.

CL_DEMO_OUTPUT=>DISPLAY( GS_DATA ).
```

```ABAP

DATA: GT_FLIGHT TYPE TABLE OF SFLIGHT,
      GS_FLIGHT LIKE LINE OF GT_FLIGHT.

PARAMETERS: PA_CAR TYPE SFLIGHT-CARRID,
            PA_CON TYPE SFLIGHT-CONNID.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_FLIGHT
  FROM SFLIGHT
  WHERE CARRID = PA_CAR
  AND CONNID = PA_CON.

* 33# ##### ## #####
SUBMIT ZABAP_B13_33
  WITH PA_CARR = PA_CAR" 33# PA_CARR = 33# PA_CAR\
  VIA SELECTION-SCREEN " # ### ## 32## # pa_car # # 33# pa_carr# ##### selection screen# ####
  AND RETURN. "Insert program## #####. ## ### ## 32# writr## ###.
* ## and return# ## ## 33# writr## ##

LOOP AT GT_FLIGHT INTO GS_FLIGHT.
  WRITE:/ GS_FLIGHT-CARRID,
          GS_FLIGHT-CONNID,
          GS_FLIGHT-FLDATE,
          GS_FLIGHT-SEATSMAX,
          GS_FLIGHT-SEATSOCC.
ENDLOOP.

DATA: GT_CONNECT TYPE TABLE OF SPFLI,
      GS_CONNECT LIKE LINE OF GT_CONNECT.
*      GS_CONNECT TYPE GT_CONNECT.

PARAMETERS: PA_CARR TYPE SPFLI-CARRID.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_CONNECT
  FROM SPFLI
  WHERE CARRID = PA_CARR.

LOOP AT GT_CONNECT INTO GS_CONNECT.
  WRITE:/ GS_CONNECT-CARRID,
          GS_CONNECT-CONNID,
          GS_CONNECT-CITYFROM,
          GS_CONNECT-CITYTO,
          GS_CONNECT-AIRPFROM,
          GS_CONNECT-AIRPTO.
ENDLOOP.


DATA: GT_SFLIGHT TYPE TABLE OF SFLIGHT.

PARAMETERS: PA_CAR TYPE SFLIGHT-CARRID.

SELECT *
  INTO TABLE GT_SFLIGHT
  FROM SFLIGHT
  WHERE CARRID = PA_CAR.

EXPORT
  FLIGHT = GT_SFLIGHT
  TO MEMORY ID 'SFT'.
  
  DATA: GT_FLIGHT TYPE TABLE OF SFLIGHT,
      GS_FLIGHT LIKE LINE OF GT_FLIGHT.

IMPORT
  FLIGHT = GT_FLIGHT
  FROM MEMORY ID 'SFT'.

LOOP AT GT_FLIGHT INTO GS_FLIGHT.
  WRITE:/ GS_FLIGHT-CARRID,
          GS_FLIGHT-CONNID,
          GS_FLIGHT-FLDATE,
          GS_FLIGHT-SEATSMAX,
          GS_FLIGHT-SEATSOCC.
ENDLOOP.
```

```ABAP
Code listing for: ZABAP_B13_36
Description: BDC
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_36
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_36.

DATA: GT_BDC TYPE TABLE OF BDCDATA,
      GS_BDC LIKE LINE OF GT_BDC.

DATA: BEGIN OF GS_DATA,
        NAME     TYPE SCUSTOM-NAME,
        POSTCODE TYPE SCUSTOM-POSTCODE,
        STREET   TYPE SCUSTOM-STREET,
        CITY     TYPE SCUSTOM-CITY,
      END OF GS_DATA.

DATA: GT_DATA LIKE TABLE OF GS_DATA.

PARAMETERS: PA_FILE TYPE STRING.

* Search Help ##### #
AT SELECTION-SCREEN ON VALUE-REQUEST FOR PA_FILE.
  PERFORM GET_FILE.


START-OF-SELECTION.

  PERFORM GET_DATA.

    LOOP AT GT_DATA INTO GS_DATA.
    GS_BDC-PROGRAM = 'SAPBC402_PGCD_CREATE_CUSTOMER'.
    GS_BDC-DYNPRO = '0100'.
    GS_BDC-DYNBEGIN = 'X'.
    APPEND GS_BDC TO GT_BDC.

    CLEAR: GS_BDC.
    GS_BDC-FNAM = 'SCUSTOM-NAME'.
    GS_BDC-FVAL = GS_DATA-NAME.
    APPEND GS_BDC TO GT_BDC.

    CLEAR: GS_BDC.
    GS_BDC-FNAM = 'SCUSTOM-STREET'.
    GS_BDC-FVAL = GS_DATA-STREET.
    APPEND GS_BDC TO GT_BDC.

    CLEAR: GS_BDC.
    GS_BDC-FNAM = 'SCUSTOM-POSTCODE'.
    GS_BDC-FVAL = GS_DATA-POSTCODE.
    APPEND GS_BDC TO GT_BDC.

    CLEAR: GS_BDC.
    GS_BDC-FNAM = 'SCUSTOM-CITY'.
    GS_BDC-FVAL = GS_DATA-CITY.
    APPEND GS_BDC TO GT_BDC.

    CLEAR: GS_BDC.
    GS_BDC-FNAM = 'BDC_OKCODE'.
    GS_BDC-FVAL = 'SAVE'.
    APPEND GS_BDC TO GT_BDC.

    CALL TRANSACTION 'BC402_CALD_CRE_CUST'
      USING GT_BDC
      MODE 'A'.

    CLEAR: GS_BDC, GT_BDC.
  ENDLOOP.

*
** ### ### : #### ##
*  GS_BDC-PROGRAM = 'SAPBC402_PGCD_CREATE_CUSTOMER'.
*  GS_BDC-DYNPRO = '0100'.
*  GS_BDC-DYNBEGIN = 'X'.
*  APPEND GS_BDC TO GT_BDC.
*
*  CLEAR: GS_BDC.
*  GS_BDC-FNAM = 'SCUSTOM-NAME'.
*  GS_BDC-FVAL = '###'.
*  APPEND GS_BDC TO GT_BDC.
*
*  CLEAR: GS_BDC.
*  GS_BDC-FNAM = 'SCUSTOM-STREET'.
*  GS_BDC-FVAL = '### ###'.
*  APPEND GS_BDC TO GT_BDC.
*
*  CLEAR: GS_BDC.
*  GS_BDC-FNAM = 'SCUSTOM-POSTCODE'.
*  GS_BDC-FVAL = '123456'.
*  APPEND GS_BDC TO GT_BDC.
*
*  CLEAR: GS_BDC.
*  GS_BDC-FNAM = 'SCUSTOM-CITY'.
*  GS_BDC-FVAL = '##'.
*  APPEND GS_BDC TO GT_BDC.
*
*  CALL TRANSACTION 'BC402_CALD_CRE_CUST'
*     USING GT_BDC
*     MODE 'A'. "####
*&---------------------------------------------------------------------*
*& Form GET_FILE
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM GET_FILE .
  DATA: LT_FILE TYPE FILETABLE,
        LS_FILE LIKE LINE OF LT_FILE,
        LV_RC   TYPE I.

  CALL METHOD CL_GUI_FRONTEND_SERVICES=>FILE_OPEN_DIALOG
    CHANGING
      FILE_TABLE              = LT_FILE             " Table Holding Selected Files
      RC                      = LV_RC      " Return Code, Number of Files or -1 If Error Occurred
    EXCEPTIONS
      FILE_OPEN_DIALOG_FAILED = 1                " "Open File" dialog failed
      CNTL_ERROR              = 2                " Control error
      ERROR_NO_GUI            = 3                " No GUI available
      NOT_SUPPORTED_BY_GUI    = 4                " GUI does not support this
      OTHERS                  = 5.

  IF SY-SUBRC = 0.
    READ TABLE LT_FILE INTO LS_FILE INDEX 1.
    PA_FILE = LS_FILE-FILENAME.
  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form GET_DATA
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM GET_DATA .
  DATA: LT_RAW   TYPE TRUXS_T_TEXT_DATA,
        LV_FNAME TYPE RLGRAP-FILENAME.

  LV_FNAME = PA_FILE.

  CALL FUNCTION 'TEXT_CONVERT_XLS_TO_SAP'
    EXPORTING
      I_TAB_RAW_DATA       = LT_RAW
      I_FILENAME           = LV_FNAME           " Local file for upload/download
    TABLES
      I_TAB_CONVERTED_DATA = GT_DATA   " Predefined Type
    EXCEPTIONS
      CONVERSION_FAILED    = 1
      OTHERS               = 2.
  IF SY-SUBRC <> 0.
*   MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*     WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.


  ENDFORM.

```

```ABAP
Code listing for: ZABAP_B13_37
Description: Program ZABAP_B13_37
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_37
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_37.

* Structure ## ##
DATA: GS_FLIGTH TYPE ZTSFLIGHT_B13,
      GT_FLIGHT TYPE TABLE OF ZTSFLIGHT_B00.

GS_FLIGTH-CARRID = 'AA'.
GS_FLIGTH-CONNID = '0017'.
GS_FLIGTH-FLDATE = SY-DATUM.
GS_FLIGTH-SEATSMAX = 370.
GS_FLIGTH-SEATSOCC = 300.

INSERT INTO ZTSFLIGHT_B13 VALUES GS_FLIGTH.

CLEAR: GS_FLIGTH.

* ### ## ### ( KEY ## )
GS_FLIGTH-CARRID = 'BB'.
GS_FLIGTH-CONNID = '0018'.
GS_FLIGTH-FLDATE = SY-DATUM.
GS_FLIGTH-SEATSMAX = 370.
GS_FLIGTH-SEATSOCC = 300.

INSERT ZTSFLIGHT_B13 FROM GS_FLIGTH.

CLEAR: GS_FLIGTH.
SELECT SINGLE *
  INTO CORRESPONDING FIELDS OF GS_FLIGTH
  FROM SFLIGHT
  WHERE CARRID = 'LH'
    AND CONNID = '0400'
    AND FLDATE = '20240225'.

INSERT INTO ZTSFLIGHT_B13 VALUES GS_FLIGTH.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_FLIGHT
  FROM SFLIGHT
  WHERE CARRID = 'LH'.

INSERT ZTSFLIGHT_B13 FROM TABLE GT_FLIGHT
ACCEPTING DUPLICATE KEYS. "######

IF SY-SUBRC = 0.
  MESSAGE 'Success, data save' TYPE 'I'.
ELSE.
  MESSAGE 'Error, data save' TYPE 'I'.
ENDIF.

```

```ABAP
Code listing for: ZABAP_B13_300
Description: Program ZABAP_B13_300
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_300
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_300.

DATA : GV_CARRID     TYPE SFLIGHT-CARRID,
       GV_CONNID     TYPE SFLIGHT-CONNID,
       GV_PAYMENTSUM TYPE I.

SELECT  CARRID CONNID AVG( PAYMENTSUM )
    INTO (GV_CARRID, GV_CONNID, GV_PAYMENTSUM)
FROM SFLIGHT GROUP BY CARRID CONNID.
  WRITE :/ GV_CARRID, GV_CONNID, GV_PAYMENTSUM.
ENDSELECT.

SELECT CARRID CONNID AVG( PAYMENTSUM )
    INTO (GV_CARRID, GV_CONNID, GV_PAYMENTSUM) FROM SFLIGHT GROUP BY CARRID CONNID
    HAVING AVG( PAYMENTSUM ) > 100000.
  ULINE.
  WRITE:/   GV_CARRID, GV_CONNID, GV_PAYMENTSUM.
ENDSELECT.

*===========================
TYPES: BEGIN OF TS_DATA,
         CARRID   TYPE S_CARR_ID,
         CONNID   TYPE S_CONN_ID,
         FLDATE   TYPE S_DATE,
         SEATSMAX TYPE S_SEATSMAX,
         SEATSOCC TYPE S_SEATSOCC,
         CITYFROM TYPE S_FROM_CIT,
         AIRPFROM TYPE S_FROMAIRP,
         CITYTO   TYPE SPFLI-CITYTO,
         AIRPTO   TYPE SPFLI-AIRPTO,
         CARRNAME TYPE SCARR-CARRNAME,
       END OF TS_DATA.

DATA: GT_DATA TYPE TABLE OF TS_DATA,
      GS_DATA LIKE LINE OF GT_DATA.

DATA: GT_SCARR TYPE TABLE OF SCARR,
      GS_SCARR LIKE LINE OF GT_SCARR.

DATA: GT_SPFLI TYPE TABLE OF SPFLI,
      GS_SPFLI LIKE LINE OF GT_SPFLI.

PARAMETERS: PA_CAR TYPE SFLIGHT-CARRID,
            PA_CON TYPE SFLIGHT-CONNID.

SELECT *
  INTO TABLE GT_SCARR
  FROM SCARR.

SELECT *
  INTO TABLE GT_SPFLI
  FROM SPFLI
  WHERE CARRID = PA_CAR.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA
  FROM SFLIGHT
  WHERE CARRID = PA_CAR
  AND CONNID = PA_CON.

LOOP AT GT_DATA INTO GS_DATA.
  READ TABLE GT_SCARR INTO GS_SCARR
  WITH KEY CARRID = GS_DATA-CARRID.
  IF SY-SUBRC = 0.
    GS_DATA-CARRNAME = GS_SCARR-CARRNAME.
  ENDIF.

  READ TABLE GT_SPFLI INTO GS_SPFLI
  WITH KEY CARRID = GS_DATA-CARRID
  CONNID = GS_DATA-CONNID.

  IF SY-SUBRC = 0.
    GS_DATA-CITYFROM = GS_SPFLI-CITYFROM.
    GS_DATA-CITYTO = GS_SPFLI-CITYTO.
    GS_DATA-AIRPFROM = GS_SPFLI-AIRPFROM.
    GS_DATA-AIRPTO = GS_SPFLI-AIRPTO.
  ENDIF.
  MODIFY GT_DATA FROM GS_DATA.
  CLEAR: GS_DATA, GS_SCARR, GS_SPFLI.
ENDLOOP.

CL_DEMO_OUTPUT=>DISPLAY( GT_DATA ).

*==================
TYPES: BEGIN OF TS_DATA2,
         CARRID     TYPE  S_CARRID,
         CARRNAME   TYPE  S_CARRNAME,
         CONNID     TYPE  S_CONN_ID,
         DAYS_AHEAD TYPE  BC400_PERC,
         FLDATE     TYPE  S_DATE,
         ORDER_DATE TYPE  S_DATE,
         DAYS       TYPE  S_CONN_ID,
       END OF TS_DATA2.

```

```ABAP
DATA flights TYPE TABLE OF spfli WITH EMPTY KEY.

START-OF-SELECTION.

SELECT * FROM  spfli
         WHERE carrid = 'LH'
         INTO TABLE @flights.

*BREAK-POINT.
DATA members LIKE flights.
LOOP AT flights INTO DATA(flight)
     GROUP BY ( carrier = flight-carrid cityfr = flight-cityfrom )
              ASCENDING
              ASSIGNING FIELD-SYMBOL(<group>).
  CLEAR members.
  LOOP AT GROUP <group> ASSIGNING FIELD-SYMBOL(<flight>).
    members = VALUE #( BASE members ( <flight> ) ).
  ENDLOOP.
  cl_demo_output=>write( members ).
ENDLOOP.
cl_demo_output=>display( ).
```

```ABAP
*&---------------------------------------------------------------------*
*& Include          ZABAP_B13_25_TOP
*&---------------------------------------------------------------------*

TABLES: SCUSTOM.

TYPES: BEGIN OF TS_DATA.
         INCLUDE TYPE SBOOK.
TYPES:   EXCP      TYPE CHAR1,
         COLOR     TYPE CHAR4,
         IT_COL    TYPE LVC_T_SCOL,
         NAME      TYPE SCUSTOM-NAME,
         PHONE     TYPE SCUSTOM-TELEPHONE,
         CANC_ICON TYPE ICON-ID,
         BTN_TXT   TYPE CHAR10,
         IT_BTN TYPE LVC_T_STYL,
       END OF TS_DATA.

DATA: GT_DATA    TYPE TABLE OF TS_DATA,
      OK_CODE    TYPE SY-UCOMM,
      GS_DATA    LIKE LINE OF GT_DATA,
      GO_CONT    TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV     TYPE REF TO CL_GUI_ALV_GRID,
      GS_VARIANT TYPE DISVARIANT,
      GS_LAYOUT  TYPE LVC_S_LAYO,
      GT_SORT    TYPE LVC_T_SORT,
      GT_TOOLBAR TYPE UI_FUNCTIONS,
      GT_FCAT    TYPE LVC_T_FCAT.


SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME.
  SELECT-OPTIONS: SO_CAR FOR GS_DATA-CARRID,
  SO_CON FOR GS_DATA-CONNID,
  SO_FDT FOR GS_DATA-FLDATE.
  PARAMETERS: PA_VARI TYPE DISVARIANT-VARIANT.
SELECTION-SCREEN END OF BLOCK BLK1.


Code listing for: ZABAP_B13_25_O01
Description: Include ZABAP_B13_25_O01
*&---------------------------------------------------------------------*
*& Include          ZABAP_B00_25_O01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OK_CODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV OUTPUT.
  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
        CONTAINER_NAME              = 'AREA'
      EXCEPTIONS
        CNTL_ERROR                  = 1
        CNTL_SYSTEM_ERROR           = 2
        CREATE_ERROR                = 3
        LIFETIME_ERROR              = 4
        LIFETIME_DYNPRO_DYNPRO_LINK = 5
        OTHERS                      = 6.
    IF SY-SUBRC <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

    CREATE OBJECT GO_ALV
      EXPORTING
        I_PARENT          = GO_CONT
      EXCEPTIONS
        ERROR_CNTL_CREATE = 1
        ERROR_CNTL_INIT   = 2
        ERROR_CNTL_LINK   = 3
        ERROR_DP_CREATE   = 4
        OTHERS            = 5.
    IF SY-SUBRC <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

    SET HANDLER LCL_EVENT_HANDLER=>ON_DOUBLE_CLICK FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_HOTSPOT_CLICK FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_TOOLBAR FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_USER_COMMAND FOR GO_ALV.
    SET HANDLER LCL_EVENT_HANDLER=>ON_BUTTON_CLICK FOR GO_ALV.



* #### ####
*    SET HANDLER:
*      LCL_EVENT_HANDLER=>ON_DOUBLE_CLICK FOR GO_ALV,
*      LCL_EVENT_HANDLER=>ON_HOTSPOT_CLICK FOR GO_ALV,
*      LCL_EVENT_HANDLER=>ON_TOOLBAR FOR GO_ALV.

    GS_VARIANT-REPORT = SY-CPROG.
    GS_VARIANT-VARIANT = PA_VARI.

    PERFORM SET_LAYOUT.
    PERFORM SET_SORT.
*    PERFORM SET_TOOLBAR_EXCLUDING.
    PERFORM SET_FCAT.

    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        I_STRUCTURE_NAME              = 'SBOOK'
        IS_VARIANT                    = GS_VARIANT
        I_SAVE                        = 'A'
        IS_LAYOUT                     = GS_LAYOUT
        IT_TOOLBAR_EXCLUDING          = GT_TOOLBAR
      CHANGING
        IT_OUTTAB                     = GT_DATA
        IT_FIELDCATALOG               = GT_FCAT
*       IT_SORT                       = GT_SORT
      EXCEPTIONS
        INVALID_PARAMETER_COMBINATION = 1
        PROGRAM_ERROR                 = 2
        TOO_MANY_LINES                = 3
        OTHERS                        = 4.
    IF SY-SUBRC <> 0.
*     Implement suitable error handling here
    ENDIF.


  ELSE.
*    CALL METHOD GO_ALV->REFRESH_TABLE_DISPLAY
*      EXCEPTIONS
*        FINISHED = 1                " Display was Ended (by Export)
*        OTHERS   = 2.
*    IF SY-SUBRC <> 0.
**     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
**       WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
*    ENDIF.
  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module STATUS_0110 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0110 OUTPUT.
  SET PF-STATUS 'S110'.
  SET TITLEBAR 'T110'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module GET_CUSTOMER OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE GET_CUSTOMER OUTPUT.
  SELECT SINGLE *
    FROM SCUSTOM
    WHERE ID = GS_DATA-CUSTOMID.
ENDMODULE.


Code listing for: ZABAP_B13_25_C01
Description: Include ZABAP_B13_25_C01
*&---------------------------------------------------------------------*
*& Include          ZABAP_B13_25_C01
*&---------------------------------------------------------------------*

CLASS LCL_EVENT_HANDLER DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      ON_DOUBLE_CLICK FOR EVENT DOUBLE_CLICK OF CL_GUI_ALV_GRID
        IMPORTING ES_ROW_NO E_COLUMN,

      ON_HOTSPOT_CLICK FOR EVENT HOTSPOT_CLICK OF CL_GUI_ALV_GRID
        IMPORTING ES_ROW_NO E_COLUMN_ID,

      "## #####
      ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
        IMPORTING E_OBJECT,

      ON_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
        IMPORTING E_UCOMM,

      ON_BUTTON_CLICK FOR EVENT BUTTON_CLICK OF CL_GUI_ALV_GRID
        IMPORTING ES_ROW_NO ES_COL_ID.

ENDCLASS.

CLASS LCL_EVENT_HANDLER IMPLEMENTATION.
  METHOD ON_DOUBLE_CLICK.
    MESSAGE I016(BC405_408)
      WITH ES_ROW_NO-ROW_ID E_COLUMN-FIELDNAME.
  ENDMETHOD.

  METHOD ON_HOTSPOT_CLICK.
*    MESSAGE I016(BC405_408)
*      WITH ES_ROW_NO-ROW_ID E_COLUMN_ID-FIELDNAME.
    READ TABLE GT_DATA INTO GS_DATA INDEX ES_ROW_NO-ROW_ID.
    IF SY-SUBRC = 0.
      CALL SCREEN 110
        STARTING AT 5 3.
    ENDIF.
  ENDMETHOD.

  METHOD ON_TOOLBAR.
    DATA: LS_BUTTON TYPE STB_BUTTON.

    LS_BUTTON-BUTN_TYPE = 3.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.
    CLEAR: LS_BUTTON.
    LS_BUTTON-FUNCTION = 'ADD'.
    LS_BUTTON-TEXT = 'Add Row'.
    LS_BUTTON-BUTN_TYPE = 0.
    LS_BUTTON-ICON = ICON_INSERT_ROW.
    LS_BUTTON-QUICKINFO = 'Insert Row'.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

    CLEAR: LS_BUTTON.
    LS_BUTTON-FUNCTION = 'DEL'.
    LS_BUTTON-BUTN_TYPE = 0.
    LS_BUTTON-ICON = ICON_DELETE_ROW.
    LS_BUTTON-QUICKINFO = 'Delete Row'.
    APPEND LS_BUTTON TO E_OBJECT->MT_TOOLBAR.

  ENDMETHOD.
  METHOD ON_USER_COMMAND.
    DATA: LV_ROW TYPE I,
          LV_COL TYPE I.

    DATA: LT_ROWS TYPE LVC_T_ROID,
          LS_ROW  TYPE LVC_S_ROID.

    CASE E_UCOMM.
      WHEN 'ADD'.
*        ### ### # #### ## ### ###### clear
        CLEAR: GS_DATA.
        INSERT GS_DATA INTO GT_DATA INDEX 1.

      WHEN 'DEL'.
        CALL METHOD GO_ALV->GET_SELECTED_ROWS
          IMPORTING
            ET_ROW_NO     = LT_ROWS            " Numeric IDs of Selected Rows

*        CALL METHOD GO_ALV->GET_CURRENT_CELL
*          IMPORTING
*            E_ROW = LV_ROW
*            E_COL = LV_COL.
**        MESSAGE I016(BC405_408) WITH LV_ROW LV_COL.
*        DELETE GT_DATA INDEX LV_ROW.
        .

    ENDCASE.
    CALL METHOD GO_ALV->REFRESH_TABLE_DISPLAY
      EXCEPTIONS
        FINISHED = 1
        OTHERS   = 2.
    IF SY-SUBRC <> 0.
*         MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*           WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.
  ENDMETHOD.

  METHOD ON_BUTTON_CLICK.
    READ TABLE GT_DATA INTO GS_DATA INDEX ES_ROW_NO-ROW_ID.

    MESSAGE I016(BC405_408)
      WITH ES_ROW_NO-ROW_ID ES_COL_ID-FIELDNAME.
  ENDMETHOD.
ENDCLASS.

include ZABAP_B13_25_TOP.
include ZABAP_B13_25_C01.
include ZABAP_B13_25_O01.
include ZABAP_B13_25_I01.
include ZABAP_B13_25_F01.


INITIALIZATION.
  PERFORM SET_INIT.

START-OF-SELECTION.
  PERFORM GET_DATA.

  CALL SCREEN 100.
  
  
  Code listing for: ZABAP_B13_25_F01
Description: Include ZABAP_B13_25_F01
*&---------------------------------------------------------------------*
*& Include          ZABAP_B13_25_F01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*& Form SET_INIT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_INIT .

  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'EQ'.
  SO_CAR-LOW = 'AZ'.
  APPEND SO_CAR.

  CLEAR: SO_CAR.
  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'BT'.
  SO_CAR-LOW = 'DL'.
  SO_CAR-HIGH = 'LH'.
  APPEND SO_CAR.

  SO_FDT-SIGN = 'I'.
  SO_FDT-OPTION = 'BT'.
  " ## ### #### ##### +0(4)
  " SY-DATUM ##, 20240813 (0### ##) # 20240101# #### #
  SO_FDT-LOW = SY-DATUM+0(4) && '0101'.
  SO_FDT-HIGH = SY-DATUM.
  APPEND SO_FDT.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form GET_DATA
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM GET_DATA .

  DATA: LS_SCOL TYPE LVC_S_SCOL.
*  DATA: LS_SCOL TYPE LINE OF LVC_T_SCOL.
*  DATA: LS_SCOL LIKE LINE OF GS_DATA-IT_COL.

  DATA: LS_BTN TYPE LVC_S_STYL.

  SELECT *
    INTO CORRESPONDING FIELDS OF TABLE GT_DATA
    FROM SBOOK
    WHERE CARRID IN SO_CAR
      AND CONNID IN SO_CON
      AND FLDATE IN SO_FDT.

  LOOP AT GT_DATA INTO GS_DATA.
    SELECT SINGLE NAME TELEPHONE
      INTO (GS_DATA-NAME, GS_DATA-PHONE)
      FROM SCUSTOM
      WHERE ID = GS_DATA-CUSTOMID.

    IF GS_DATA-CANCELLED = 'X'.
      GS_DATA-CANC_ICON = ICON_SYSTEM_CANCEL.
    ENDIF.

    IF GS_DATA-INVOICE = 'X'.
      LS_SCOL-FNAME = 'INVOICE'.
      LS_SCOL-COLOR-COL = '6'.
      LS_SCOL-COLOR-INT = '1'.
      LS_SCOL-COLOR-INV = '0'.
      APPEND LS_SCOL TO GS_DATA-IT_COL.

      LS_BTN-FIELDNAME = 'BTN_TXT'.
      LS_BTN-STYLE = CL_GUI_ALV_GRID=>MC_STYLE_BUTTON.
      APPEND LS_BTN TO GS_DATA-IT_BTN.

      GS_DATA-BTN_TXT = 'InVoice'.
    ENDIF.

    IF GS_DATA-CLASS = 'Y'.
      LS_SCOL-FNAME = 'CLASS'.
      LS_SCOL-COLOR-COL = '3'.
      LS_SCOL-COLOR-INT = '1'.
      LS_SCOL-COLOR-INV = '0'.
      APPEND LS_SCOL TO GS_DATA-IT_COL.
    ENDIF.

    IF GS_DATA-FORCURKEY = 'EUR'.
      LS_SCOL-FNAME = 'FORCURKEY'.
      LS_SCOL-COLOR-COL = '5'.
      LS_SCOL-COLOR-INT = '1'.
      LS_SCOL-COLOR-INV = '0'.
      APPEND LS_SCOL TO GS_DATA-IT_COL.
    ENDIF.


    IF GS_DATA-SMOKER = 'X'.
      GS_DATA-COLOR = 'C710'.
*      GS_DATA-COLOR = 'C' && COL_GROUP && '00'.
*      CONCATENATE 'C' COL_GROUP '00' INTO GS_DATA-COLOR.
    ENDIF.
    IF GS_DATA-FORCURAM < 500.
      GS_DATA-EXCP = '1'.
    ELSEIF GS_DATA-FORCURAM >= 500 AND GS_DATA-FORCURAM < 1000.
      GS_DATA-EXCP = '2'.
    ELSE.
      GS_DATA-EXCP = '3'.
    ENDIF.
    MODIFY GT_DATA FROM GS_DATA.
    CLEAR: GS_DATA.
  ENDLOOP.

ENDFORM.
*&---------------------------------------------------------------------*
*& Form SET_LAYOUT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_LAYOUT .
  GS_LAYOUT-GRID_TITLE = 'Booking List'.
  GS_LAYOUT-ZEBRA = 'X'.
  GS_LAYOUT-CWIDTH_OPT = 'X'.
*  GS_LAYOUT-NO_TOOLBAR = 'X'.
  GS_LAYOUT-TOTALS_BEF = 'X'.
  GS_LAYOUT-SEL_MODE = 'D'.
  GS_LAYOUT-EXCP_FNAME = 'EXCP'.
  GS_LAYOUT-EXCP_LED = 'X'.
  GS_LAYOUT-INFO_FNAME = 'COLOR'.
  GS_LAYOUT-CTAB_FNAME = 'IT_COL'.
  GS_LAYOUT-STYLEFNAME = 'IT_BTN'.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form SET_SORT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_SORT .
  DATA: LS_SORT TYPE LVC_S_SORT.
  LS_SORT-FIELDNAME = 'CUSTOMID'.
  LS_SORT-DOWN = 'X'.
  APPEND LS_SORT TO GT_SORT.

  CLEAR: LS_SORT.
  LS_SORT-FIELDNAME = 'ORDER_DATE'.
  LS_SORT-UP = 'X'.
  APPEND LS_SORT TO GT_SORT.
ENDFORM.

*&---------------------------------------------------------------------*
*& Form SET_TOOLBAR_EXCLUDING
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_TOOLBAR_EXCLUDING .
*  APPEND CL_GUI_ALV_GRID=>MC_FC_DETAIL TO GT_TOOLBAR.
*  APPEND CL_GUI_ALV_GRID=>MC_MB_SUM TO GT_TOOLBAR.
*  APPEND CL_GUI_ALV_GRID=>MC_FC_FILTER TO GT_TOOLBAR.

  APPEND CL_GUI_ALV_GRID=>MC_FC_EXCL_ALL TO GT_TOOLBAR.
ENDFORM.

FORM SET_FCAT .

  DATA: LS_FCAT TYPE LVC_S_FCAT.

  LS_FCAT-FIELDNAME = 'NAME'.
  LS_FCAT-REF_TABLE = 'SCUSTOM'.
  LS_FCAT-COL_POS = 7.
  LS_FCAT-HOTSPOT = 'X'.
*  LS_FCAT-JUST = 'R'.
*  LS_FCAT-REF_FIELD = 'NAME'.
  APPEND LS_FCAT TO GT_FCAT.

  CLEAR: LS_FCAT.
  LS_FCAT-FIELDNAME = 'PHONE'.
  LS_FCAT-REF_TABLE = 'SCUSTOM'.
  LS_FCAT-REF_FIELD = 'TELEPHONE'.
  LS_FCAT-COL_POS = 8.
  APPEND LS_FCAT TO GT_FCAT.

  CLEAR: LS_FCAT.
  LS_FCAT-FIELDNAME = 'CANC_ICON'.
  LS_FCAT-COLTEXT = 'Cancelled'.
  LS_FCAT-ICON = 'X'.
  APPEND LS_FCAT TO GT_FCAT.

  CLEAR: LS_FCAT.
  LS_FCAT-FIELDNAME = 'CANCELLED'.
*  LS_FCAT-NO_OUT = 'X'.
  LS_FCAT-CHECKBOX = 'X'.
  APPEND LS_FCAT TO GT_FCAT.

  CLEAR: LS_FCAT.
  LS_FCAT-FIELDNAME = 'EXCP'.
  LS_FCAT-COLTEXT = 'Statue'.
  APPEND LS_FCAT TO GT_FCAT.

  CLEAR: LS_FCAT.
  LS_FCAT-FIELDNAME = 'INVOICE'.
*  LS_FCAT-CHECKBOX = 'X'.
*  LS_FCAT-STYLE = CL_GUI_ALV_GRID=>MC_STYLE_BUTTON.
  APPEND LS_FCAT TO GT_FCAT.

  CLEAR: LS_FCAT.
  LS_FCAT-FIELDNAME = 'BTN_TXT'.
  LS_FCAT-COLTEXT = 'Button'.
*  LS_FCAT-STYLE = CL_GUI_ALV_GRID=>MC_STYLE_BUTTON.
  APPEND LS_FCAT TO GT_FCAT.

ENDFORM.
```

````ABAP
Code listing for: ZABAP_B13_26
Description: ALV Field Catalog
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_26
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_26.

* Internal table & work area (Structure variable)
DATA : BEGIN OF GS_DATA,
         CARRID    TYPE SFLIGHT-CARRID,
         CARRNAME  TYPE SCARR-CARRNAME,
         CONNID    TYPE SFLIGHT-CONNID,
         FLDATE    TYPE SFLIGHT-FLDATE,
         SEATSMAX  TYPE SFLIGHT-SEATSMAX,
         SEATSOCC  TYPE SFLIGHT-SEATSOCC,
         SEATSFREE TYPE SFLIGHT-SEATSMAX,
         BOOKRATE  TYPE P  LENGTH 3 DECIMALS 2,
       END OF GS_DATA,
       GT_DATA LIKE TABLE OF GS_DATA.

* Screen Functions function code.
DATA: OK_CODE   TYPE SY-UCOMM,
      " ALV Layout ##
      GS_LAYOUT TYPE LVC_S_LAYO,
      " ACL Field catalog ##
      GT_FCAT   TYPE LVC_T_FCAT,
      " Container control & ALV Grid Control ## ##.
      GO_CONT   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV    TYPE REF TO CL_GUI_ALV_GRID.

* selection screen.
SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME TITLE TEXT-T01.
  SELECT-OPTIONS: SO_CAR FOR GS_DATA-CARRID,
                  SO_CON FOR GS_DATA-CONNID.
SELECTION-SCREEN END OF BLOCK BLK1.

INITIALIZATION.
  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'EQ'.
  SO_CAR-LOW = 'AZ'.
  APPEND SO_CAR.

  CLEAR SO_CAR.

  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'BT'.
  SO_CAR-LOW = 'LH'.
  SO_CAR-HIGH = 'UA'.
  APPEND SO_CAR.

  CLEAR SO_CAR.

  SO_CAR-SIGN = 'E'.
  SO_CAR-OPTION = 'EQ'.
  SO_CAR-LOW = 'QF'.
  APPEND SO_CAR.

START-OF-SELECTION.
  SELECT *
    INTO CORRESPONDING FIELDS OF TABLE GT_DATA
    FROM SFLIGHT
    WHERE CARRID IN SO_CAR
    AND CONNID IN SO_CON.

  LOOP AT GT_DATA INTO GS_DATA.
    GS_DATA-SEATSFREE = GS_DATA-SEATSMAX - GS_DATA-SEATSOCC.
    GS_DATA-BOOKRATE = GS_DATA-SEATSOCC / GS_DATA-SEATSMAX * 100.
    MODIFY GT_DATA FROM GS_DATA.
    CLEAR: GS_DATA.
  ENDLOOP.

  CALL SCREEN 100.
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OK_CODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL' OR 'EXIT'.
      LEAVE TO SCREEN 0.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV OUTPUT.
*  Contatiner Control ###### ## , ## ### ### ###### ### ###
  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
        CONTAINER_NAME              = 'AREA'
      EXCEPTIONS
        CNTL_ERROR                  = 1
        CNTL_SYSTEM_ERROR           = 2
        CREATE_ERROR                = 3
        LIFETIME_ERROR              = 4
        LIFETIME_DYNPRO_DYNPRO_LINK = 5
        OTHERS                      = 6.
    IF SY-SUBRC <> 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

*    ALV GRID ##
    CREATE OBJECT GO_ALV
      EXPORTING
        I_PARENT          = GO_CONT
      EXCEPTIONS
        ERROR_CNTL_CREATE = 1
        ERROR_CNTL_INIT   = 2
        ERROR_CNTL_LINK   = 3
        ERROR_DP_CREATE   = 4
        OTHERS            = 5.
    IF SY-SUBRC <> 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

*   ### ### ##. ## ### #### #### ### ##
    GS_LAYOUT-ZEBRA = 'X'.
    GS_LAYOUT-CWIDTH_OPT = 'X'.

    PERFORM SET_FCAT.

* DISPLAY
    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT       = GS_LAYOUT
      CHANGING
        IT_OUTTAB       = GT_DATA
        IT_FIELDCATALOG = GT_FCAT.
    IF SY-SUBRC <> 0.
* Implement suitable error handling here
    ENDIF.

  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Form SET_FCAT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_FCAT .
* #### #### ## FUNCTION, PERFORM #### # ## ### ### ###
  PERFORM FILL_FCAT USING:
*  Col_pos Fieldname    Ref_table   Ref_field Coltext
  '1'     'CARRID'      'SFLIGHT'      ''    '',
  '2'     'CARRNAME'    'SCARR'        ''    '',
  '3'     'CONNID'      'SFLIGHT'      ''    '',
  '4'     'FLDATE'      'SFLIGHT'      ''    '',
  '5'     'SEATSMAX'    'SFLIGHT'      ''    '',
  '6'     'SEATSOCC'    'SFLIGHT'      ''    '',
  '7'     'SEATFREE'    ''      ''    'FREE Seats',
  '8'     'BOOKRATE'    ''      ''    'Book Rate'.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form FILL_FCAT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&---------------------------------------------------------------------*
FORM FILL_FCAT  USING PV_COLOPS    TYPE LVC_S_FCAT-COL_POS
                      PV_FIELDNAME TYPE LVC_S_FCAT-FIELDNAME
                      PV_REFTABLE  TYPE LVC_S_FCAT-REF_TABLE
                      PV_REFFIELD  TYPE LVC_S_FCAT-REF_FIELD
                      PV_COLTEXT   TYPE LVC_S_FCAT-COLTEXT.

  DATA: LS_FCAT TYPE LVC_S_FCAT.

  LS_FCAT-COL_POS   = PV_COLOPS.
  LS_FCAT-FIELDNAME = PV_FIELDNAME.
  LS_FCAT-REF_TABLE = PV_REFTABLE.
  LS_FCAT-REF_FIELD = PV_REFFIELD.
  LS_FCAT-COLTEXT   = PV_COLTEXT.

  APPEND LS_FCAT TO GT_FCAT.

ENDFORM.
````

````ABAP
Code listing for: ZABAP_B13_27
Description: ALV Field Catalog
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_26
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_27.

* Internal table & work area (Structure variable)
DATA: GT_DATA  TYPE TABLE OF ZSSEATS_B00,
      GS_DATA  LIKE LINE OF GT_DATA,
      GT_SCARR TYPE TABLE OF SCARR,
      GS_SCARR LIKE LINE OF GT_SCARR.

*DATA : BEGIN OF GS_DATA,
*         CARRID    TYPE SFLIGHT-CARRID,
*         CARRNAME  TYPE SCARR-CARRNAME,
*         CONNID    TYPE SFLIGHT-CONNID,
*         FLDATE    TYPE SFLIGHT-FLDATE,
*         SEATSMAX  TYPE SFLIGHT-SEATSMAX,
*         SEATSOCC  TYPE SFLIGHT-SEATSOCC,
*         SEATSFREE TYPE SFLIGHT-SEATSMAX,
*         BOOKRATE  TYPE P  LENGTH 3 DECIMALS 2,
*       END OF GS_DATA,
*       GT_DATA LIKE TABLE OF GS_DATA.

* Screen Functions function code.
DATA: OK_CODE   TYPE SY-UCOMM,
      " ALV Layout ##
      GS_LAYOUT TYPE LVC_S_LAYO,
      " ACL Field catalog ##
      GT_FCAT   TYPE LVC_T_FCAT,
      " Container control & ALV Grid Control ## ##.
      GO_CONT   TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV    TYPE REF TO CL_GUI_ALV_GRID.

* selection screen.
SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME TITLE TEXT-T01.
  SELECT-OPTIONS: SO_CAR FOR GS_DATA-CARRID,
                  SO_CON FOR GS_DATA-CONNID.
SELECTION-SCREEN END OF BLOCK BLK1.

INITIALIZATION.
* ### ##, ##, ### ####.
  SELECT * INTO TABLE GT_SCARR
    FROM SCARR.

  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'EQ'.
  SO_CAR-LOW = 'AZ'.
  APPEND SO_CAR.

  CLEAR SO_CAR.

  SO_CAR-SIGN = 'I'.
  SO_CAR-OPTION = 'BT'.
  SO_CAR-LOW = 'LH'.
  SO_CAR-HIGH = 'UA'.
  APPEND SO_CAR.

  CLEAR SO_CAR.

  SO_CAR-SIGN = 'E'.
  SO_CAR-OPTION = 'EQ'.
  SO_CAR-LOW = 'QF'.
  APPEND SO_CAR.

START-OF-SELECTION.
  SELECT *
    INTO CORRESPONDING FIELDS OF TABLE GT_DATA
    FROM SFLIGHT
    WHERE CARRID IN SO_CAR
    AND CONNID IN SO_CON.

  LOOP AT GT_DATA INTO GS_DATA.

    READ TABLE GT_SCARR INTO GS_SCARR
    WITH KEY CARRID = GS_DATA-CARRID.
    IF SY-SUBRC = 0.
      GS_DATA-CARRNAME = GS_SCARR-CARRNAME.
    ENDIF.

    GS_DATA-SEATSFREE = GS_DATA-SEATSMAX - GS_DATA-SEATSOCC.
    GS_DATA-BOOKRATE = GS_DATA-SEATSOCC / GS_DATA-SEATSMAX * 100.
    MODIFY GT_DATA FROM GS_DATA.
    CLEAR: GS_DATA.
  ENDLOOP.

  CALL SCREEN 100.
*&---------------------------------------------------------------------*
*& Module STATUS_0100 OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE STATUS_0100 OUTPUT.
  SET PF-STATUS 'S100'.
  SET TITLEBAR 'T100'.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module CLEAR_OK_CODE OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE CLEAR_OK_CODE OUTPUT.
  CLEAR: OK_CODE.
ENDMODULE.
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0100  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0100 INPUT.
  CASE OK_CODE.
    WHEN 'BACK' OR 'CANCEL' OR 'EXIT'.
      LEAVE TO SCREEN 0.
  ENDCASE.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Module INIT_ALV OUTPUT
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
MODULE INIT_ALV OUTPUT.
*  Contatiner Control ###### ## , ## ### ### ###### ### ###
  IF GO_CONT IS INITIAL.
    CREATE OBJECT GO_CONT
      EXPORTING
        CONTAINER_NAME              = 'AREA'
      EXCEPTIONS
        CNTL_ERROR                  = 1
        CNTL_SYSTEM_ERROR           = 2
        CREATE_ERROR                = 3
        LIFETIME_ERROR              = 4
        LIFETIME_DYNPRO_DYNPRO_LINK = 5
        OTHERS                      = 6.
    IF SY-SUBRC <> 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

*    ALV GRID ##
    CREATE OBJECT GO_ALV
      EXPORTING
        I_PARENT          = GO_CONT
      EXCEPTIONS
        ERROR_CNTL_CREATE = 1
        ERROR_CNTL_INIT   = 2
        ERROR_CNTL_LINK   = 3
        ERROR_DP_CREATE   = 4
        OTHERS            = 5.
    IF SY-SUBRC <> 0.
*     MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*                WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    ENDIF.

*   ### ### ##. ## ### #### #### ### ##
    GS_LAYOUT-ZEBRA = 'X'.
    GS_LAYOUT-CWIDTH_OPT = 'X'.

    PERFORM SET_FCAT.

* DISPLAY
    CALL METHOD GO_ALV->SET_TABLE_FOR_FIRST_DISPLAY
      EXPORTING
        IS_LAYOUT       = GS_LAYOUT
      CHANGING
        IT_OUTTAB       = GT_DATA
        IT_FIELDCATALOG = GT_FCAT.
    IF SY-SUBRC <> 0.
* Implement suitable error handling here
    ENDIF.

  ENDIF.
ENDMODULE.
*&---------------------------------------------------------------------*
*& Form SET_FCAT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*& -->  p1        text
*& <--  p2        text
*&---------------------------------------------------------------------*
FORM SET_FCAT .
*  Structure type# ### ###### ## ##### #####.
*  #### ### ### ## #####.
  DATA: LS_FCAT TYPE LVC_S_FCAT.
  CALL FUNCTION 'LVC_FIELDCATALOG_MERGE'
    EXPORTING
*     I_BUFFER_ACTIVE        =
      I_STRUCTURE_NAME       = 'ZSSEATS_B00'
*     I_CLIENT_NEVER_DISPLAY = 'X'
*     I_BYPASSING_BUFFER     =
*     I_INTERNAL_TABNAME     =
    CHANGING
      CT_FIELDCAT            = GT_FCAT
    EXCEPTIONS
      INCONSISTENT_INTERFACE = 1
      PROGRAM_ERROR          = 2
      OTHERS                 = 3.
  IF SY-SUBRC <> 0.
* Implement suitable error handling here
  ENDIF.

  LOOP AT GT_FCAT INTO LS_FCAT.
    CASE LS_FCAT-FIELDNAME.
      WHEN 'carrname'.
        LS_FCAT-HOTSPOT = 'X'.
    ENDCASE.
    MODIFY GT_FCAT FROM LS_FCAT.
    CLEAR: LS_FCAT.
  ENDLOOP.

* #### #### ## FUNCTION, PERFORM #### # ## ### ### ###
*  PERFORM FILL_FCAT USING:
**  Col_pos Fieldname    Ref_table   Ref_field Coltext
*  '1'     'CARRID'      'SFLIGHT'      ''    '',
*  '2'     'CARRNAME'    'SCARR'        ''    '',
*  '3'     'CONNID'      'SFLIGHT'      ''    '',
*  '4'     'FLDATE'      'SFLIGHT'      ''    '',
*  '5'     'SEATSMAX'    'SFLIGHT'      ''    '',
*  '6'     'SEATSOCC'    'SFLIGHT'      ''    '',
*  '7'     'SEATFREE'    ''      ''    'FREE Seats',
*  '8'     'BOOKRATE'    ''      ''    'Book Rate'.
ENDFORM.
*&---------------------------------------------------------------------*
*& Form FILL_FCAT
*&---------------------------------------------------------------------*
*& text
*&---------------------------------------------------------------------*
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&      --> P_
*&---------------------------------------------------------------------*
*FORM FILL_FCAT  USING PV_COLOPS    TYPE LVC_S_FCAT-COL_POS
*                      PV_FIELDNAME TYPE LVC_S_FCAT-FIELDNAME
*                      PV_REFTABLE  TYPE LVC_S_FCAT-REF_TABLE
*                      PV_REFFIELD  TYPE LVC_S_FCAT-REF_FIELD
*                      PV_COLTEXT   TYPE LVC_S_FCAT-COLTEXT.
*
*  DATA: LS_FCAT TYPE LVC_S_FCAT.
*
*  LS_FCAT-COL_POS   = PV_COLOPS.
*  LS_FCAT-FIELDNAME = PV_FIELDNAME.
*  LS_FCAT-REF_TABLE = PV_REFTABLE.
*  LS_FCAT-REF_FIELD = PV_REFFIELD.
*  LS_FCAT-COLTEXT   = PV_COLTEXT.
*
*  APPEND LS_FCAT TO GT_FCAT.
*
*ENDFORM.
````

```ABAP
Code listing for: ZABAP_B13_28
Description: FOR ALL ENTRIES
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_28
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_28.

DATA: BEGIN OF GS_BOOK,
        CARRID   TYPE SBOOK-CARRID,
        CONNID   TYPE SBOOK-CONNID,
        FLDATE   TYPE SBOOK-FLDATE,
        BOOKID   TYPE SBOOK-BOOKID,
        CUSTOMID TYPE SBOOK-CUSTOMID,
        NAME     TYPE SCUSTOM-NAME,
        STREET   TYPE SCUSTOM-STREET,
        CITY     TYPE SCUSTOM-CITY,
        POSTCODE TYPE SCUSTOM-POSTCODE,
      END OF GS_BOOK,
      GT_BOOK LIKE TABLE OF GS_BOOK.

SELECT-OPTIONS: SO_CAR FOR GS_BOOK-CARRID,
                SO_CON FOR GS_BOOK-CONNID,
                SO_FDT FOR GS_BOOK-FLDATE.

* SBOOK #### ## CUSTOMID# #### SCUSTOM# ## ## ### ###
* GT_BOOK# SBOOK ### ## (## ### ####)
SELECT * INTO CORRESPONDING FIELDS OF TABLE GT_BOOK
  FROM SBOOK
  WHERE CARRID IN SO_CAR
    AND CONNID IN SO_CON
    AND FLDATE IN SO_FDT.

DATA: GT_CUSTOM TYPE TABLE OF SCUSTOM,
      GS_CUSTOM LIKE LINE OF GT_CUSTOM,
      GT_TMP LIKE GT_BOOK.

* NULL ##
IF GT_BOOK IS NOT INITIAL.
*  GT_BOOK# ## ### ### GT_TMP# ## # ### ## ####
  GT_TMP = GT_BOOK.
* CUSTOMID ## ### ## ## # ## ## -> DELETE
  SORT GT_TMP BY CUSTOMID.
  DELETE ADJACENT DUPLICATES FROM GT_TMP COMPARING CUSTOMID.

  SELECT *
    INTO CORRESPONDING FIELDS OF TABLE GT_CUSTOM
    FROM SCUSTOM
    FOR ALL ENTRIES IN GT_TMP
    WHERE ID = GT_TMP-CUSTOMID.
ENDIF.

LOOP AT GT_BOOK INTO GS_BOOK.
  READ TABLE GT_CUSTOM INTO GS_CUSTOM
  WITH KEY ID = GS_BOOK-CUSTOMID.

  IF SY-SUBRC = 0.
    MOVE-CORRESPONDING GS_CUSTOM TO GS_BOOK.
  ENDIF.

  MODIFY GT_BOOK FROM GS_BOOK.
  CLEAR: GS_BOOK, GS_CUSTOM.
ENDLOOP.

CL_DEMO_OUTPUT=>DISPLAY( GT_BOOK ).
```

```ABAP

DATA: BEGIN OF GS_FLIGHT,
        CARRID TYPE SFLIGHT-CARRID,
        CONNID TYPE SFLIGHT-CONNID,
        TOTMAX TYPE SFLIGHT-SEATSMAX,
        TOTOCC TYPE SFLIGHT-SEATSOCC,
        ROWCNT TYPE I,
      END OF GS_FLIGHT,
      GT_FLIGHT LIKE TABLE OF GS_FLIGHT.

SELECT-OPTIONS: SO_CAR FOR GS_FLIGHT-CARRID.

SELECT CARRID CONNID
  SUM( SEATSMAX )
  SUM( SEATSOCC )
  COUNT( * )
  INTO TABLE GT_FLIGHT
  FROM SFLIGHT
  WHERE CARRID IN SO_CAR
  AND SEATSOCC > 300
  GROUP BY CARRID CONNID
  HAVING SUM( SEATSOCC ) >= 3500.

SORT GT_FLIGHT BY CARRID CONNID.

CL_DEMO_OUTPUT=>DISPLAY( GT_FLIGHT ).
```

```ABAP

DATA: GS_SPFLI TYPE SPFLI.

SELECTION-SCREEN BEGIN OF SCREEN 1100 AS SUBSCREEN.
  SELECT-OPTIONS: SO_CAR FOR GS_SPFLI-CARRID,
                  SO_CON FOR GS_SPFLI-CONNID.
  PARAMETERS: PA_ALL RADIOBUTTON GROUP RB1 DEFAULT 'X',
              PA_NAT RADIOBUTTON GROUP RB1,
              PA_INT RADIOBUTTON GROUP RB1.
SELECTION-SCREEN END OF SCREEN 1100.

SELECTION-SCREEN BEGIN OF SCREEN 1200 AS SUBSCREEN.
  PARAMETERS: PA_FDT TYPE SFLIGHT-FLDATE,
              PA_LOW AS CHECKBOX,
              PA_HIG AS CHECKBOX.
SELECTION-SCREEN END OF SCREEN 1200.

SELECTION-SCREEN BEGIN OF SCREEN 1300 AS SUBSCREEN.
  PARAMETERS: PA_ID   TYPE SCUSTOM-ID,
              PA_NAME TYPE SCUSTOM-NAME.
SELECTION-SCREEN END OF SCREEN 1300.

SELECTION-SCREEN BEGIN OF TABBED BLOCK TAB_BLK FOR 10 LINES.
  SELECTION-SCREEN TAB (20) TAB1 USER-COMMAND FC1 DEFAULT SCREEN 1100.
  SELECTION-SCREEN TAB (20) TAB2 USER-COMMAND FC2 DEFAULT SCREEN 1200.
  SELECTION-SCREEN TAB (20) TAB3 USER-COMMAND FC3 DEFAULT SCREEN 1300.
SELECTION-SCREEN END OF BLOCK TAB_BLK.

INITIALIZATION.
  TAB1 = 'Connection'.
  TAB2 = 'Flight'.
  TAB3 = 'Customer'.

  TAB_BLK-ACTIVETAB = 'FC3'.
  TAB_BLK-DYNNR = 1300.
```

```ABAP
Code listing for: ZABAP_B13_16
Description: Program ZABAP_B13_16
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_16
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_16.

TYPES: BEGIN OF TS_DATA,
         CARRID   TYPE S_CARR_ID,
         CONNID   TYPE S_CONN_ID,
         FLDATE   TYPE S_DATE,
         SEATSMAX TYPE S_SEATSMAX,
         SEATSOCC TYPE S_SEATSOCC,
         CITYFROM TYPE S_FROM_CIT,
         AIRPFROM TYPE S_FROMAIRP,
         CITYTO   TYPE SPFLI-CITYTO,
         AIRPTO   TYPE SPFLI-AIRPTO,
         CARRNAME TYPE SCARR-CARRNAME,
       END OF TS_DATA.

DATA: GT_DATA TYPE TABLE OF TS_DATA,
      GS_DATA LIKE LINE OF GT_DATA.

DATA: GT_SCARR TYPE TABLE OF SCARR,
      GS_SCARR LIKE LINE OF GT_SCARR.

DATA: GT_SPFLI TYPE TABLE OF SPFLI,
      GS_SPFLI LIKE LINE OF GT_SPFLI.

PARAMETERS: PA_CAR TYPE SFLIGHT-CARRID,
            PA_CON TYPE SFLIGHT-CONNID.

SELECT *
  INTO TABLE GT_SCARR
  FROM SCARR.

SELECT *
  INTO TABLE GT_SPFLI
  FROM SPFLI
  WHERE CARRID = PA_CAR.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA
  FROM SFLIGHT
  WHERE CARRID = PA_CAR
  AND CONNID = PA_CON.

LOOP AT GT_DATA INTO GS_DATA.
  READ TABLE GT_SCARR INTO GS_SCARR
  WITH KEY CARRID = GS_DATA-CARRID.
  IF SY-SUBRC = 0.
    GS_DATA-CARRNAME = GS_SCARR-CARRNAME.
  ENDIF.

  READ TABLE GT_SPFLI INTO GS_SPFLI
  WITH KEY CARRID = GS_DATA-CARRID
  CONNID = GS_DATA-CONNID.

  IF SY-SUBRC = 0.
    GS_DATA-CITYFROM = GS_SPFLI-CITYFROM.
    GS_DATA-CITYTO = GS_SPFLI-CITYTO.
    GS_DATA-AIRPFROM = GS_SPFLI-AIRPFROM.
    GS_DATA-AIRPTO = GS_SPFLI-AIRPTO.
  ENDIF.
  MODIFY GT_DATA FROM GS_DATA.
  CLEAR: GS_DATA, GS_SCARR, GS_SPFLI.
ENDLOOP.

CL_DEMO_OUTPUT=>DISPLAY( GT_DATA ).
```

```ABAP
DATA: GT_FLIGHT TYPE TABLE OF SFLIGHT,
      GS_FLIGHT LIKE LINE OF GT_FLIGHT.

CONSTANTS: GC_MARK TYPE CHAR1 VALUE 'X'.

PARAMETERS: PA_CAR TYPE SCARR-CARRID MEMORY ID CAR,
            PA_SMK AS CHECKBOX,
            PA_NON AS CHECKBOX DEFAULT 'X',
            PA_ALL RADIOBUTTON GROUP RB1,
            PA_NAT RADIOBUTTON GROUP RB1 DEFAULT 'X',
            PA_INT RADIOBUTTON GROUP RB1,
            PA_STR TYPE CHAR10 LOWER CASE.

INITIALIZATION.
*  PA_CAR = 'LH'.

AT SELECTION-SCREEN.
  IF PA_CAR = 'AA'.
    MESSAGE 'AA ### ## #####!' TYPE 'E'.
  ENDIF.

START-OF-SELECTION.

  IF PA_SMK IS INITIAL.
  ELSE.
  ENDIF.

  IF PA_NON IS NOT INITIAL.
  ELSE.
  ENDIF.

*CASE 'X'.
  CASE GC_MARK.
    WHEN PA_ALL.
    WHEN PA_NAT.
    WHEN PA_INT.
  ENDCASE.

  SELECT *
    INTO TABLE GT_FLIGHT
    FROM SFLIGHT
    WHERE CARRID = PA_CAR.

  LOOP AT GT_FLIGHT INTO GS_FLIGHT.
    WRITE:/ GS_FLIGHT-CARRID,
            GS_FLIGHT-CONNID,
            GS_FLIGHT-FLDATE,
            GS_FLIGHT-SEATSMAX,
            GS_FLIGHT-SEATSOCC.
  ENDLOOP.
```

```ABAP
Code listing for: ZABAP_B13_22
Description: Report ZABAP_B13_22
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_22
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_22.

DATA: GV_CARRID TYPE SCARR-CARRID,
      GV_MODE   TYPE I.

TABLES: SSCRFIELDS.

DATA: GS_FLIGHT TYPE SFLIGHT.

SELECTION-SCREEN BEGIN OF BLOCK BLK1 WITH FRAME TITLE TEXT-T01.
  SELECT-OPTIONS: SO_CAR FOR GV_CARRID MEMORY ID CAR,
                  SO_CON FOR GS_FLIGHT-CONNID MODIF ID CHG.

  SELECTION-SCREEN SKIP 1.

  SELECTION-SCREEN BEGIN OF BLOCK BLK2 WITH FRAME.

    SELECTION-SCREEN BEGIN OF LINE.
      SELECTION-SCREEN COMMENT 1(25) TEXT-C01.

      SELECTION-SCREEN COMMENT POS_LOW(5) TEXT-C02 FOR FIELD PA_H.
      PARAMETERS: PA_H RADIOBUTTON GROUP RB1 DEFAULT 'X'.

      SELECTION-SCREEN COMMENT 45(5) TEXT-C03 FOR FIELD PA_M.
      PARAMETERS: PA_M RADIOBUTTON GROUP RB1.

      SELECTION-SCREEN COMMENT POS_HIGH(5) TEXT-C04.
      PARAMETERS: PA_L RADIOBUTTON GROUP RB1.
    SELECTION-SCREEN END OF LINE.

  SELECTION-SCREEN END OF BLOCK BLK2.

  SELECTION-SCREEN PUSHBUTTON /POS_LOW(20) BTN USER-COMMAND MODE.

SELECTION-SCREEN END OF BLOCK BLK1.

INITIALIZATION.
  BTN = 'Display/Change'.
*  SO_CAR-SIGN = 'I'.
*  SO_CAR-OPTION = 'BT'.
*  SO_CAR-LOW = 'AA'.
*  SO_CAR-HIGH = 'DL'.
*  APPEND SO_CAR.
*
*  CLEAR: SO_CAR.
*  SO_CAR-SIGN = 'I'.
*  SO_CAR-OPTION = 'EQ'.
*  SO_CAR-LOW  = 'UA'.
*  APPEND SO_CAR.
*
*  CLEAR: SO_CAR.
*  SO_CAR-SIGN = 'E'.
*  SO_CAR-OPTION = 'EQ'.
*  SO_CAR-LOW  = 'AZ'.
*  APPEND SO_CAR.

AT SELECTION-SCREEN OUTPUT.
  LOOP AT SCREEN.
    IF SCREEN-GROUP1 = 'chg'.
      SCREEN-INPUT = GV_MODE.
    ENDIF.
    MODIFY SCREEN.
  ENDLOOP.

AT SELECTION-SCREEN.
  CASE SSCRFIELDS-UCOMM.
    WHEN 'MODE'.
*      MESSAGE 'Push Button' TYPE 'I'.
      IF GV_MODE IS INITIAL.
        GV_MODE = 1.
      ELSE.
        CLEAR: GV_MODE.
      ENDIF.
    ENDCASE.

START-OF-SELECTION.

  SELECT *
    INTO GS_FLIGHT
    FROM SFLIGHT
    WHERE CARRID IN SO_CAR.

    WRITE:/ GS_FLIGHT-CARRID,
            GS_FLIGHT-CONNID,
            GS_FLIGHT-FLDATE,
            GS_FLIGHT-SEATSMAX,
            GS_FLIGHT-SEATSOCC.
  ENDSELECT.

```

```ABAP
Code listing for: ZABAP_B13_09
Description: Program ZABAP_B13_09
*&---------------------------------------------------------------------*
*& Report ZABAP_B13_09
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT ZABAP_B13_09.

CLASS LCL_COMPUTE DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      GET_TOTALAMT IMPORTING  IV_AMT   TYPE I
                              IV_VAT   TYPE I
                   EXPORTING  EV_TOTAL TYPE I
                   EXCEPTIONS NO_ZERO,

      GET_RADI IMPORTING  IV_RADI   TYPE I
                          IV_TYPE   TYPE CHAR1
               EXPORTING  EV_RESULT TYPE BC400_PERC
               EXCEPTIONS NO_TYPE
                          NO_ZERO.
ENDCLASS.

CLASS LCL_COMPUTE IMPLEMENTATION.
  METHOD GET_TOTALAMT.
    IF IV_AMT = 0.
      EV_TOTAL = 0.
      RAISE NO_ZERO.
    ELSE.
      EV_TOTAL = IV_AMT + IV_AMT * IV_VAT / 100.
    ENDIF.
  ENDMETHOD.

  METHOD GET_RADI.

  ENDMETHOD.
ENDCLASS.

DATA: GV_RESULT TYPE I.

PARAMETERS: PA_AMT TYPE I,
            PA_VAT TYPE I.

START-OF-SELECTION.
  CALL METHOD LCL_COMPUTE=>GET_TOTALAMT
    EXPORTING
      IV_AMT   = PA_AMT
      IV_VAT   = PA_VAT
    IMPORTING
      EV_TOTAL = GV_RESULT
    EXCEPTIONS
      NO_ZERO  = 1
      OTHERS   = 2.

  IF SY-SUBRC = 0.
    WRITE:/ 'Result : ', GV_RESULT.
  ELSEIF SY-SUBRC = 1.
    WRITE:/ 'Input zero'.
  ELSE.
    WRITE:/ 'Unknow Error'.
  ENDIF.

```

```ABAP
```


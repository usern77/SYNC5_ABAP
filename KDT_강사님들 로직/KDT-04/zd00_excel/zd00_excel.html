<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZD00_EXCEL</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZD00_EXCEL</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  [D00] Excel upload + download</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Report ZD00_EXCEL</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
REPORT zd00_excel.

include <a href ="zd00_excel_top.html">zd00_excel_top</a>.
include <a href ="zd00_excel_sel.html">zd00_excel_sel</a>.
include <a href ="zd00_excel_o01.html">zd00_excel_o01</a>.
include <a href ="zd00_excel_i01.html">zd00_excel_i01</a>.
include <a href ="zd00_excel_f01.html">zd00_excel_f01</a>.

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">* INITIALIZATION</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
INITIALIZATION.
  sscrfields-functxt_01 = '테이블형태로템플릿다운로드'.
  sscrfields-functxt_02 = 'SMW0에서다운로드'.
  sscrfields-functxt_03 = '3'.
<font color ="#0000FF">*  sscrfields-functxt_04 = '4'.</font>
<font color ="#0000FF">*  sscrfields-functxt_05 = '5'.</font>

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">* AT SELECTION-SCREEN</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
AT SELECTION-SCREEN.
  CASE sscrfields-ucomm.
    WHEN 'FC01'.
      PERFORM download_excel. "테이블 속성 (딕셔너리)
    WHEN 'FC02'.
<font color ="#0000FF">*      PERFORM download_smw0_opt1.</font>
      PERFORM download_smw0_opt2.  "SMW0
<font color ="#0000FF">*    WHEN 'FC03'.</font>
<font color ="#0000FF">*      PERFORM download_smw0_opt3.</font>
  ENDCASE.

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">* AT SELECTION-SCREEN ON VALUE-REQUEST FOR  (F4)</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
AT SELECTION-SCREEN ON VALUE-REQUEST FOR pa_file.
  PERFORM get_filenm CHANGING pa_file.

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">* START-OF-SELECTION</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
START-OF-SELECTION.
  PERFORM check_before_process.
  PERFORM upload_excel.      " 기존 방법
<font color ="#0000FF">*  PERFORM upload_excel_ole.   " 시트 선택</font>

  CALL SCREEN 100.

<font color ="#0000FF">*GUI Texts</font>
<font color ="#0000FF">*----------------------------------------------------------</font>
<font color ="#0000FF">* T100 --&gt; [D00] 업로드결과 및 저장</font>

<font color ="#0000FF">*Text elements</font>
<font color ="#0000FF">*----------------------------------------------------------</font>
<font color ="#0000FF">* Q01 저장하시겠습니까?</font>


<font color ="#0000FF">*Selection texts</font>
<font color ="#0000FF">*----------------------------------------------------------</font>
<font color ="#0000FF">* PA_FILE         업로드 파일명</font>


<font color ="#0000FF">*Messages</font>
<font color ="#0000FF">*----------------------------------------------------------</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* Message class: ALSMEX</font>
<font color ="#0000FF">*037   Error during import of clipboard contents</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* Message class: BC405</font>
<font color ="#0000FF">*006   &</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* Message class: KX</font>
<font color ="#0000FF">*001   & & & &</font>
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 754
</font>
</body>
</html>
